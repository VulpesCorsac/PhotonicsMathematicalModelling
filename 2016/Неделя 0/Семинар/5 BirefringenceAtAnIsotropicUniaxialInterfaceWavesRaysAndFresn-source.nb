(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    240911,       5822]
NotebookOptionsPosition[    238442,       5746]
NotebookOutlinePosition[    239154,       5772]
CellTagsIndexPosition[    239111,       5769]
WindowTitle->Birefringence at an Isotropic-Uniaxial Interface: Waves, Rays, \
and Fresnel Coefficients - Source
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Birefringence at an Isotropic-Uniaxial Interface: Waves, Rays, and Fresnel \
Coefficients\
\>", "Section",
 CellFrame->{{0, 0}, {0, 0}},
 ShowCellBracket->False,
 FontColor->RGBColor[0.597406, 0, 0.0527047]],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJztnVuSozgWQDNiPqa3MJ+zpVlCbaB3WlGVNV9dvYH6TQRUph/ZGIHQmwvG
xoZzQu3Aku7VfUj4Nk53//fLn//78q+Xl5f/NP/88e+Xl8v154Xj5+fp89y0
4+X63L7VnQu02XqOt9FzjRK5qtRMoYZFpk11/Ji+WDye92+r7+fFfbnGkuu9
eIQ4LBVJ+YRo5DPnRdITDp0TLRg6m/62nY/n08f5+H461G37fWqum57z4Xy2
jby0prMZOh4/jodLOx2bt6fzRSEA3B/KMKGSBy/DSKVcyYOn8krHqajvqed6
G6iol4qkfAIVNQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADsizPA/lj72AEA
AMCmWLu0AXh01j6jAAAAcdb+hNwUJ5e1zZnPDEeey/e1jx0AAABsirVLm03x
XFVlhs1X1JNY+4wCAAB02B9PJ4BdsvYpBAAAgOeGihpADo9GAUDIr+Lnr7ef
a9vw16/i73VtMPx6+2v1gGwMijeAE89FAQA2DRW1BxX14lBRA0wi+lx0baMA
AAAAAAAAAAAAbkj0uegR4L4cDoe1TYA1YQMAbIaDy9rm3JU9+w4AjwB3np3D
BgDYDHuuKu/su3k0ynNRACGLHMy93dm2ijCPpHvD7LliAQAAmA0VNRioqIGK
GlYk9Vz0AAAAAAAAAAAAALBR9KPR8Kf0a9sFAAAAAAAAAAAAcCt4LgoAAAAA
AAAAAAB7I/Vc9ONheH9/X9uEzUJsZ0PoAGBZ3gNuLQgggR21GUjl7SC2syF0
ALAsVNQgxMv14XAI/xOja9sIAAAAT0lYWM5jbT/msGffAQAAAGAp9lxV3sF3
b1r0uehSZgAAAAAAAAAAAAA8Ar9b6rpuXpu3+tf0PBcFWJcFvxYBAAAAANgh
VNQAADCK5LnobwAAAAAAAAAAAIANUbcPRav+wehH7LmoUqpsqKqmNTSXRVE0
by593mtRXlrfo7mImTlVN6ebUOhR07q3jmxVWXqquqxVOUjZq1eDVNe662ro
Nxe1Xr5o2lt5cUc7VWr3BpGindNL6TkDl5nVIGWtbuaXWbwJo/OVKjSX68oL
shMTO4ylHf+yy5GbhU5EubJJPeWgx5ayBfvOIR2qD5QJXWmFtJs2pLsLvu40
4oOesh/tJ3TKW/3DomZONgVdVPtNXvVXYWydyBRl/NWNWNW62L06G344TcNW
L/SVpaTqcmeOWGWOm3W+TFPWsbL8dE1yklUal73ghDtBH+Hu1dE/HBM7/t7h
sjNoN29Calrl2GadWfsMeoc0elcR584clrm5qzO5a+5mQe4imy2Tu1qcu+g2
7od7mkvVtqJtajgInQuqzUrRtWFCzIAkzQdK0/RR1U33JEhtgOhosnmLKtX0
DArVhaJHtZOlmgPbVN+mWZhRGzNvEc13MD61kIRcEPS2WciRp/C97a0ow569
DCOVRurZU0lFnUoBFbWkKiv7I0xFLc4dFXUAFfVUtVTUYRD2V1EnfTd7u920
v+va/NXoSXM86qXVwFtzgNvS7vJG3730Ga76Wkq/6lFz3dlWOa+69XpUOSix
ixQtrrVV1pxBleO+uesMsv6QjenXF+bViFjGO5rtObaUp7bVoENe21Kqy1Un
1M8xOaxNftysOh61q5joKStQpbkIQ2p54HRWXcqsOsbVU7oZNBr8Fbv+yotk
GBkvbuFbu9/LkY6DF3ZvTvqtOVXdBi0dlN6WZekEsHfQ2flmjpnQ+25vfn//
2yH1eswnokp/tNkpsJNrTqJruX4tzAkKBJXJVdUbbJmtrwtrUfuoGm2Ru5S3
AcrEGQyPld3jzbFTH+oP+is3d+XVuev2wI1zN9w8rZM1I3dFf203xxKvuUyT
TevJkd8JSzF7iVHBzJa+D0vFZJLapawNh6xiQ91ixaf03R+lDHvaMqwPCKl8
+lRGgkZF3W3Q0oGKmoq685yKmoo6L5jZ0vdhqZhMUruUteEQFfUk37VU98C8
qRvq+uPjQz8UPZ/P+snoZYIqVAwtaFY0r+E0+8l8VIM3Gs70JkelUoLR0XBm
2X5dldcmWS5lQ2r1jDue+DBaRvrzvidVpc2WOKJicRvVZu+HaFqjgpngC/MS
Fek2rRvSjKCy9rnxfepWFFKokVMzWaEsU9GDbEYnbfuoYOpGkdcwql/Sv+fc
CVdJcY1a+Yo3WuUaZsfE+9S+j3mTRuFZoAxL9eTtFK6ecccTH0bnlmGkMtXz
dKnMLCTpifZTUUfnyNOR4QGrstQuHTXGFqSiXiV3wlVSXKNWvuKNVrmG2TGh
ooZb0+T0rUWf/br9e1HvuWjR/z1/+JOUIujKPxYu+l9YCEX0kGVARDxjjHxa
ygZv6ejF6KiE0cfp0eUk6JMrmVamQx1qkPTIRzNSo4LC0OnbV7S/tD7WRw32
ElFYP1/y7EkZn09lPhHedej7vDiHSkbzq79YsWcWfUUUzYgXf7mdqa04eiK0
ebYxe86d9yE+T3n+OzuVqHbMx01Up/kkCud7Q0ZJ5uvCRQhNGvVCoueayK9O
mKP8qDDd9szol7b5AM5LSup0P7LvxXBX8dWGvlCGTTJm1IBwianK3QySyo2k
clR/KtShBkmPfDQjNSpIRS0xexJRy8NjS0UtMfVBcmegoh6FijrkEarKPVfU
Gd89w+rwd/Tt34uq/kuT6C2xsG5WhXvLsu+KUb+8/kxsvQMryUIxdp8PLc/c
FiblXaJEcgvKuODFf54N8yYXwYejZ2fUbO8i5b7kXwRSPfJtFu1JWZ7BtlZu
eRg9XXJEbcuriorIU2xkjYjQi2hJFjXeFvFmhjeNUWu9HhO3/LQoe8tdSKqC
ys+f+tE5aZVoBSU0T87U+sr2emq4Ur7k9eQrhydiaqiF3LqSX4QFfacMk684
yaT7l2GkUr7iJJOoqKMrUlGPritxZ9RyT9aIUFHn133e3IVQUQvVUlHPhor6
1r6r/k9G9X1A/47+dDrZ/9+lb9++vbr8+PHDe7X7w077rafHU+JNTo1GF/Wu
U52hhtCjqGEZJVGdoZsp5ZmZoRe2kc3Fd0tnKGKvJQ9UKr8pRh15dY0MZTOO
e/pTa43OSUmFpn5Pbzzv7agveTNCJRnZ70FCX4OU5ZWn9KfiELrpLZ3aIZn0
RYmGN+NRPsIpd7y19pa7qIhQZ15coicVmamMLjpb1SLmLUgmzlOtzau6RRAm
bYxFTJoh9Vy+U4aNKonqDN1MKc/MDL2wjXydWIaRylElz5LKVExSS2Scigqm
HHl1jQxlM457+lNrjc5JSYWmUlF7jqQ2RmqHZNIXJRrejEf5CKfc8dbaW+6i
IkKdeXGJnlRkpjK66GxVi5i3IJk4T7U2r+oWQZi0MRYxaYbUZnyPLvH/lte2
FP/69esnAAAAAAAAAAAAwM74B4thROM=
   "], {{0, 0}, {1800, 25}}, {0, 255},
   ColorFunction->RGBColor],
  ImageSize->{1800, 25},
  PlotRange->{{0, 1800}, {0, 25}}]], "Section",
 CellFrame->{{0, 0}, {0, 0}},
 ShowCellBracket->False],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Calculations", " ", "and", " ", "graphics", " ", "for", " ", "Fresnel", 
     " ", "amplitudes"}], ",", " ", 
    RowBox[{"phases", " ", "and", " ", "power", " ", "ratios"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"power", ":=", "\[IndentingNewLine]", 
     RowBox[{"(", "\t\t", 
      RowBox[{
       RowBox[{"\[Theta]init", "=", "0.0"}], ";", 
       RowBox[{"\[CapitalDelta]\[Theta]", "=", "step"}], ";", 
       RowBox[{"max", "=", 
        RowBox[{"90.", "/", "step"}]}], ";", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "0"}], ",", 
         RowBox[{"i", "\[LessEqual]", "max"}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]i", "[", "i", "]"}], "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "<", "max"}], ",", 
             RowBox[{"\[Theta]init", "+", 
              RowBox[{"i", "*", "\[CapitalDelta]\[Theta]"}]}], ",", 
             RowBox[{"\[Theta]init", "+", 
              RowBox[{"i", "*", "\[CapitalDelta]\[Theta]"}], "-", "0.01"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\[Theta]inr", "=", 
           RowBox[{
            RowBox[{"\[Theta]i", "[", "i", "]"}], "*", 
            FractionBox["\[Pi]", "180."]}]}], ";", 
          RowBox[{"\[Theta]or", "=", 
           RowBox[{"ArcSin", "[", 
            FractionBox[
             RowBox[{"ni", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"\[Theta]i", "[", "i", "]"}], "*", 
                FractionBox["\[Pi]", "180."]}], "]"}]}], "no"], "]"}]}], ";", 
          
          RowBox[{
           RowBox[{"ango", "[", "i", "]"}], "=", "\[Theta]or"}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"m1", "=", "\[IndentingNewLine]", "\t ", 
           RowBox[{"FindRoot", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{
              RowBox[{"ni", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{"\[Theta]i", "[", "i", "]"}], "*", 
                 FractionBox["\[Pi]", "180."]}], "]"}]}], "==", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"no", "*", "ne"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"\[Sqrt]", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["no", "2"], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["ne", "2"], "-", 
                    SuperscriptBox["no", "2"]}], ")"}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "d\[Theta]", "]"}]}], 
                    RowBox[{"Cos", "[", 
                    FractionBox[
                    RowBox[{"\[Pi]", " ", "\[Theta]"}], "180."], "]"}], 
                    RowBox[{"Sin", "[", 
                    FractionBox[
                    RowBox[{"\[Pi]", " ", "Q"}], "180."], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"Cos", "[", "d\[Theta]", "]"}], 
                    RowBox[{"Cos", "[", 
                    FractionBox[
                    RowBox[{"Q", "*", "\[Pi]"}], "180."], "]"}], 
                    RowBox[{"Cos", "[", 
                    FractionBox[
                    RowBox[{"\[Pi]", " ", "\[Theta]"}], "180."], "]"}]}]}], 
                    ")"}], "2"]}]}], ")"}]}], ")"}]}], "*", 
               RowBox[{"Sin", "[", "d\[Theta]", "]"}]}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"{", 
              RowBox[{"d\[Theta]", ",", 
               RowBox[{
                FractionBox[
                 RowBox[{"Re", "[", "\[Theta]or", "]"}], "2"], "-", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Re", "[", "\[Theta]or", "]"}], "5"], "I"}]}]}], 
              "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\[Theta]er", "=", 
           RowBox[{"d\[Theta]", "/.", "m1"}]}], ";", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"n\[CurlyPhi]", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"no", "*", "ne"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"\[Sqrt]", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["no", "2"], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["ne", "2"], "-", 
                   SuperscriptBox["no", "2"]}], ")"}], 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "\[Theta]er", "]"}]}], 
                    RowBox[{"Cos", "[", 
                    FractionBox[
                    RowBox[{"\[Pi]", " ", "\[Theta]"}], "180."], "]"}], 
                    RowBox[{"Sin", "[", 
                    FractionBox[
                    RowBox[{"\[Pi]", " ", "Q"}], "180."], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"Cos", "[", "\[Theta]er", "]"}], 
                    RowBox[{"Cos", "[", 
                    FractionBox[
                    RowBox[{"Q", "*", "\[Pi]"}], "180."], "]"}], 
                    RowBox[{"Cos", "[", 
                    FractionBox[
                    RowBox[{"\[Pi]", " ", "\[Theta]"}], "180."], "]"}]}]}], 
                   ")"}], "2"]}]}], ")"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xe", ",", "ye", ",", "ze"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"n\[CurlyPhi]", " ", 
              RowBox[{"Sin", "[", "\[Theta]er", "]"}]}], ",", 
             RowBox[{"n\[CurlyPhi]", " ", 
              RowBox[{"Cos", "[", "\[Theta]er", "]"}]}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"ke", "=", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"Sin", "[", "\[Theta]er", "]"}], ",", 
             RowBox[{"Cos", "[", "\[Theta]er", "]"}]}], "}"}]}], ";", 
          RowBox[{"ko", "=", 
           RowBox[{"So", "=", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"Sin", "[", "\[Theta]or", "]"}], ",", 
              RowBox[{"Cos", "[", "\[Theta]or", "]"}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"oa", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sin", "[", 
              FractionBox[
               RowBox[{"\[Pi]", " ", "\[Theta]"}], "180."], "]"}], ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Cos", "[", 
                FractionBox[
                 RowBox[{"\[Pi]", " ", "\[Theta]"}], "180."], "]"}]}], 
              RowBox[{"Sin", "[", 
               FractionBox[
                RowBox[{"\[Pi]", " ", "Q"}], "180."], "]"}]}], ",", 
             RowBox[{
              RowBox[{"Cos", "[", 
               FractionBox[
                RowBox[{"\[Pi]", " ", "\[Theta]"}], "180."], "]"}], 
              RowBox[{"Cos", "[", 
               FractionBox[
                RowBox[{"\[Pi]", " ", "Q"}], "180."], "]"}]}]}], "}"}]}], ";",
           "\[IndentingNewLine]", "\t\t", 
          RowBox[{"xse", "=", 
           RowBox[{
            FractionBox["1", 
             RowBox[{
              SuperscriptBox["ne", "2"], " ", 
              SuperscriptBox["no", "2"]}]], 
            RowBox[{"(", 
             RowBox[{"ne", "-", "no"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"ne", "+", "no"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ze", " ", 
               RowBox[{"Cos", "[", 
                FractionBox[
                 RowBox[{"\[Pi]", " ", "Q"}], "180."], "]"}]}], "-", 
              RowBox[{"ye", " ", 
               RowBox[{"Sin", "[", 
                FractionBox[
                 RowBox[{"\[Pi]", " ", "Q"}], "180."], "]"}]}]}], ")"}], " ", 
            
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"\[Pi]", " ", "\[Theta]"}], "90."], "]"}]}]}], ";", 
          RowBox[{"yse", "=", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"4", " ", 
              SuperscriptBox["ne", "2"], " ", 
              SuperscriptBox["no", "2"]}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               SuperscriptBox["ne", "2"], " ", "ye"}], "+", 
              RowBox[{"6", " ", 
               SuperscriptBox["no", "2"], " ", "ye"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ne", "-", "no"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"ne", "+", "no"}], ")"}], " ", "\[IndentingNewLine]", 
               "\t", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "ye", " ", 
                  RowBox[{"Cos", "[", 
                   FractionBox[
                    RowBox[{"\[Pi]", " ", "\[Theta]"}], "90."], "]"}]}], "-", 
                 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ye", "-", "ze"}], ")"}], " ", 
                  RowBox[{"Cos", "[", 
                   FractionBox[
                    RowBox[{"\[Pi]", " ", "Q"}], "90."], "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"Cos", "[", 
                    FractionBox[
                    RowBox[{"\[Pi]", " ", "\[Theta]"}], "90."], "]"}]}], 
                   ")"}]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ye", "+", "ze"}], ")"}], " ", 
                  RowBox[{"Cos", "[", 
                   FractionBox[
                    RowBox[{"\[Pi]", " ", "Q"}], "90."], "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"Cos", "[", 
                    FractionBox[
                    RowBox[{"\[Pi]", " ", "\[Theta]"}], "90."], "]"}]}], 
                   ")"}]}], "-", 
                 RowBox[{"4", " ", "ze", " ", 
                  SuperscriptBox[
                   RowBox[{"Cos", "[", 
                    FractionBox[
                    RowBox[{"\[Pi]", " ", "\[Theta]"}], "180."], "]"}], "2"], 
                  " ", 
                  RowBox[{"Sin", "[", 
                   FractionBox[
                    RowBox[{"\[Pi]", " ", "Q"}], "90."], "]"}]}]}], ")"}]}]}],
              ")"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"zse", "=", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"4", " ", 
              SuperscriptBox["ne", "2"], " ", 
              SuperscriptBox["no", "2"]}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               SuperscriptBox["ne", "2"], " ", "ze"}], "+", 
              RowBox[{"6", " ", 
               SuperscriptBox["no", "2"], " ", "ze"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ne", "-", "no"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"ne", "+", "no"}], ")"}], "\[IndentingNewLine]", "\t", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "ze", " ", 
                  RowBox[{"Cos", "[", 
                   FractionBox[
                    RowBox[{"\[Pi]", " ", "\[Theta]"}], "90."], "]"}]}], "-", 
                 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ye", "-", "ze"}], ")"}], " ", 
                  RowBox[{"Cos", "[", 
                   FractionBox[
                    RowBox[{"\[Pi]", " ", "Q"}], "90."], "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"Cos", "[", 
                    FractionBox[
                    RowBox[{"\[Pi]", " ", "\[Theta]"}], "90."], "]"}]}], 
                   ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ye", "+", "ze"}], ")"}], " ", 
                  RowBox[{"Cos", "[", 
                   FractionBox[
                    RowBox[{"\[Pi]", " ", "Q"}], "90."], "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"Cos", "[", 
                    FractionBox[
                    RowBox[{"\[Pi]", " ", "\[Theta]"}], "90."], "]"}]}], 
                   ")"}]}], "-", 
                 RowBox[{"4", " ", "ye", " ", 
                  SuperscriptBox[
                   RowBox[{"Cos", "[", 
                    FractionBox[
                    RowBox[{"\[Pi]", " ", "\[Theta]"}], "180."], "]"}], "2"], 
                  " ", 
                  RowBox[{"Sin", "[", 
                   FractionBox[
                    RowBox[{"\[Pi]", " ", "Q"}], "90."], "]"}]}]}], ")"}]}]}],
              ")"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Se", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xSe", ",", "ySe", ",", "zSe"}], "}"}], "=", 
            RowBox[{"Normalize", "[", 
             RowBox[{"{", 
              RowBox[{"xse", ",", "yse", ",", "zse"}], "}"}], "]"}]}]}], ";", 
          
          RowBox[{"\[Theta]Se", "=", 
           RowBox[{"VectorAngle", "[", 
            RowBox[{"Se", ",", 
             RowBox[{"{", 
              RowBox[{"0.", ",", "0.", ",", "1."}], "}"}]}], "]"}]}], ";", 
          RowBox[{
           RowBox[{"angS", "[", "i", "]"}], "=", "\[Theta]Se"}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"ki", "=", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"Sin", "[", "\[Theta]inr", "]"}], ",", 
             RowBox[{"Cos", "[", "\[Theta]inr", "]"}]}], "}"}]}], ";", 
          RowBox[{"kip", "=", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"Cos", "[", "\[Theta]inr", "]"}], ",", 
             RowBox[{"-", 
              RowBox[{"Sin", "[", "\[Theta]inr", "]"}]}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"kr", "=", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"Sin", "[", "\[Theta]inr", "]"}], ",", 
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Theta]inr", "]"}]}]}], "}"}]}], ";", 
          RowBox[{"krp", "=", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Theta]inr", "]"}]}], ",", 
             RowBox[{"-", 
              RowBox[{"Sin", "[", "\[Theta]inr", "]"}]}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\[Theta]Er", "=", 
           RowBox[{"\[Theta]Einc", "*", 
            FractionBox["\[Pi]", "180."]}]}], ";", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"Einc", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]pol", "*", 
               FractionBox["\[Pi]", "180."]}], "]"}], " ", 
             RowBox[{"{", 
              RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]pol", "*", 
               FractionBox["\[Pi]", "180."]}], "]"}], "kip"}]}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\[Theta]s", "=", 
           RowBox[{"VectorAngle", "[", 
            RowBox[{"ke", ",", "Se"}], "]"}]}], ";", 
          RowBox[{"nS", "=", 
           RowBox[{"n\[CurlyPhi]", " ", 
            RowBox[{"Cos", "[", "\[Theta]s", "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Eref", "=", 
           RowBox[{
            RowBox[{"rs", " ", 
             RowBox[{"{", 
              RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}], "+", 
            RowBox[{"rp", " ", "krp"}]}]}], ";", " ", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Theta]", "\[Equal]", "0"}], "\[Or]", 
             RowBox[{"no", "\[Equal]", "ne"}]}], ",", 
            RowBox[{"dirEord", "=", 
             RowBox[{"{", 
              RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}], ",", 
            RowBox[{"dirEord", "=", 
             RowBox[{"Normalize", "[", 
              RowBox[{"Cross", "[", 
               RowBox[{"ko", ",", "oa"}], "]"}], "]"}]}]}], "]"}], ";", 
          RowBox[{"Eord", "=", 
           RowBox[{"to", "  ", "dirEord"}]}], ";", " ", "\[IndentingNewLine]",
           "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Q", "\[Equal]", "0"}], "&&", 
              RowBox[{
               RowBox[{"\[Theta]i", "[", "i", "]"}], "\[Equal]", "0"}], "&&", 
              
              RowBox[{"\[Theta]", "\[Equal]", "0"}]}], "\[Or]", 
             RowBox[{"no", "\[Equal]", "ne"}]}], ",", 
            RowBox[{"dirEext", "=", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"Cos", "[", "\[Theta]er", "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"Sin", "[", "\[Theta]er", "]"}]}]}], "}"}]}], ",", 
            RowBox[{"dirEext", "=", 
             RowBox[{"Normalize", "[", 
              RowBox[{"Cross", "[", 
               RowBox[{
                RowBox[{"Cross", "[", 
                 RowBox[{"ke", ",", "oa"}], "]"}], ",", "Se"}], "]"}], 
              "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Eext", "=", 
           RowBox[{"te", "  ", "dirEext"}]}], ";", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"Hinc", "=", 
           RowBox[{"ni", " ", 
            RowBox[{"Cross", "[", 
             RowBox[{"ki", ",", "Einc"}], "]"}]}]}], ";", 
          RowBox[{"Href", "=", 
           RowBox[{"ni", " ", 
            RowBox[{"Cross", "[", 
             RowBox[{"kr", ",", "Eref"}], "]"}]}]}], ";", 
          RowBox[{"Hord", "=", 
           RowBox[{"no", " ", 
            RowBox[{"Cross", "[", 
             RowBox[{"ko", ",", "Eord"}], "]"}]}]}], ";", 
          RowBox[{"Hext", "=", 
           RowBox[{"n\[CurlyPhi]", " ", 
            RowBox[{"Cross", "[", 
             RowBox[{"ke", ",", "Eext"}], "]"}]}]}], ";", " ", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"fresnel", "=", 
           RowBox[{"Flatten", "[", "\[IndentingNewLine]", "\t ", 
            RowBox[{"Solve", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", "\t", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Einc", "+", "Eref"}], ")"}], ".", 
                  RowBox[{"{", 
                   RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}], "\[Equal]", 
                 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Eord", "+", "Eext"}], ")"}], ".", 
                  RowBox[{"{", 
                   RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}]}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Einc", "+", "Eref"}], ")"}], ".", 
                  RowBox[{"{", 
                   RowBox[{"0.", ",", "1.", ",", "0."}], "}"}]}], "\[Equal]", 
                 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Eord", "+", "Eext"}], ")"}], ".", 
                  RowBox[{"{", 
                   RowBox[{"0.", ",", "1.", ",", "0."}], "}"}]}]}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Hinc", "+", "Href"}], ")"}], ".", 
                  RowBox[{"{", 
                   RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}], "\[Equal]", 
                 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Hord", "+", "Hext"}], ")"}], ".", 
                  RowBox[{"{", 
                   RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}]}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Hinc", "+", "Href"}], ")"}], ".", 
                  RowBox[{"{", 
                   RowBox[{"0.", ",", "1.", ",", "0."}], "}"}]}], "\[Equal]", 
                 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Hord", "+", "Hext"}], ")"}], ".", 
                  RowBox[{"{", 
                   RowBox[{"0.", ",", "1.", ",", "0."}], "}"}]}]}]}], 
               "\[IndentingNewLine]", "\t", "}"}], ",", "\[IndentingNewLine]",
               "\t ", 
              RowBox[{"{", 
               RowBox[{"rs", ",", "rp", ",", "to", ",", "te"}], "}"}]}], 
             "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           SubscriptBox["rs", 
            RowBox[{"\[Theta]i", "[", "i", "]"}]], "=", 
           RowBox[{"fresnel", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
          RowBox[{
           SubscriptBox["rp", 
            RowBox[{"\[Theta]i", "[", "i", "]"}]], "=", 
           RowBox[{"fresnel", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", 
          RowBox[{
           SubscriptBox["to", 
            RowBox[{"\[Theta]i", "[", "i", "]"}]], "=", 
           RowBox[{"fresnel", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ";", 
          RowBox[{
           SubscriptBox["te", 
            RowBox[{"\[Theta]i", "[", "i", "]"}]], "=", 
           RowBox[{"fresnel", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           SubscriptBox["Rp", 
            RowBox[{"\[Theta]i", "[", "i", "]"}]], "=", 
           RowBox[{"Chop", "[", 
            RowBox[{
             SubscriptBox["rp", 
              RowBox[{"\[Theta]i", "[", "i", "]"}]], " ", 
             RowBox[{
              SubscriptBox["rp", 
               RowBox[{"\[Theta]i", "[", "i", "]"}]], "\[Conjugate]"}]}], 
            "]"}]}], ";", 
          RowBox[{
           SubscriptBox["Rs", 
            RowBox[{"\[Theta]i", "[", "i", "]"}]], "=", 
           RowBox[{"Chop", "[", 
            RowBox[{
             SubscriptBox["rs", 
              RowBox[{"\[Theta]i", "[", "i", "]"}]], " ", 
             RowBox[{
              SubscriptBox["rs", 
               RowBox[{"\[Theta]i", "[", "i", "]"}]], "\[Conjugate]"}]}], 
            "]"}]}], ";", 
          RowBox[{
           SubscriptBox["To", 
            RowBox[{"\[Theta]i", "[", "i", "]"}]], "=", 
           RowBox[{"Chop", "[", 
            RowBox[{"Re", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"no", " ", 
                RowBox[{"Cos", "[", "\[Theta]or", "]"}]}], 
               RowBox[{"ni", " ", 
                RowBox[{"Cos", "[", "\[Theta]inr", "]"}]}]], " ", 
              SubscriptBox["to", 
               RowBox[{"\[Theta]i", "[", "i", "]"}]], " ", 
              RowBox[{
               SubscriptBox["to", 
                RowBox[{"\[Theta]i", "[", "i", "]"}]], "\[Conjugate]"}]}], 
             "]"}], "]"}]}], ";", 
          RowBox[{
           SubscriptBox["Te", 
            RowBox[{"\[Theta]i", "[", "i", "]"}]], "=", 
           RowBox[{"Chop", "[", 
            RowBox[{"Re", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"nS", " ", 
                RowBox[{"Cos", "[", "\[Theta]Se", "]"}]}], 
               RowBox[{"ni", " ", 
                RowBox[{"Cos", "[", "\[Theta]inr", "]"}]}]], 
              SubscriptBox["te", 
               RowBox[{"\[Theta]i", "[", "i", "]"}]], " ", 
              RowBox[{
               SubscriptBox["te", 
                RowBox[{"\[Theta]i", "[", "i", "]"}]], "\[Conjugate]"}]}], 
             "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "\t", "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"transo", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Theta]i", "[", "i", "]"}], ",", 
            RowBox[{"Chop", "[", 
             RowBox[{"ango", "[", "i", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "max"}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "the", " ", "refraction", " ", "angles", " ", "of", " ", "the", " ", 
         "ordinary", " ", 
         RowBox[{"ray", "/", "wave"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"transe", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Theta]i", "[", "i", "]"}], ",", 
            RowBox[{"Chop", "[", 
             RowBox[{"angS", "[", "i", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "max"}], "}"}]}], "]"}]}], ";", "  ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "the", " ", "refraction", " ", "angles", " ", "of", " ", "the", " ", 
          "extraordinary", " ", "ray"}], ",", " ", 
         RowBox[{"NOT", " ", "wave"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"dataRp", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Theta]i", "[", "i", "]"}], ",", 
            SubscriptBox["Rp", 
             RowBox[{"\[Theta]i", "[", "i", "]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "max"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"brewster", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Theta]pol", "\[NotEqual]", "0"}], ",", 
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Sort", "[", 
             RowBox[{"dataRp", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "<", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "]"}], "[",
            
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", "  ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "extracting", " ", "the", " ", "Brewster", " ", "angle", " ", "from", 
         " ", "the", " ", "Rp", " ", "values"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"tiro", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ni", "\[GreaterEqual]", "no"}], ",", 
          RowBox[{
           RowBox[{"Last", "[", 
            RowBox[{"Cases", "[", 
             RowBox[{"transo", ",", 
              RowBox[{"{", 
               RowBox[{"_Real", ",", "_Real"}], "}"}]}], "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<No TIR\>\""}], "]"}]}], 
       ";", "  ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"extracting", " ", "the", " ", "o"}], "-", 
         RowBox[{
         "critical", " ", "angle", " ", "from", " ", "the", " ", "refraction",
           " ", "values"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"tire", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ni", "\[GreaterEqual]", "ne"}], ",", 
          RowBox[{
           RowBox[{"Last", "[", 
            RowBox[{"Cases", "[", 
             RowBox[{"transe", ",", 
              RowBox[{"{", 
               RowBox[{"_Real", ",", "_Real"}], "}"}]}], "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<No TIR\>\""}], "]"}]}], 
       ";", "  ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"extracting", " ", "the", " ", "e"}], "-", 
         RowBox[{
         "critical", " ", "angle", " ", "from", " ", "the", " ", "refraction",
           " ", "values"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "\[IndentingNewLine]", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"plot", "==", "\"\<Fresnel (R, T)\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"dataRs", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Theta]i", "[", "i", "]"}], ",", 
               SubscriptBox["Rs", 
                RowBox[{"\[Theta]i", "[", "i", "]"}]]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "max"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dataTo", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Theta]i", "[", "i", "]"}], ",", 
               SubscriptBox["To", 
                RowBox[{"\[Theta]i", "[", "i", "]"}]]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "max"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dataTe", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Theta]i", "[", "i", "]"}], ",", 
               SubscriptBox["Te", 
                RowBox[{"\[Theta]i", "[", "i", "]"}]]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "max"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dataRtotal", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Theta]i", "[", "i", "]"}], ",", 
               RowBox[{
                SubscriptBox["Rs", 
                 RowBox[{"\[Theta]i", "[", "i", "]"}]], "+", 
                SubscriptBox["Rp", 
                 RowBox[{"\[Theta]i", "[", "i", "]"}]]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "max"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dataTotal", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Theta]i", "[", "i", "]"}], ",", 
               RowBox[{
                SubscriptBox["Rs", 
                 RowBox[{"\[Theta]i", "[", "i", "]"}]], "+", 
                SubscriptBox["Rp", 
                 RowBox[{"\[Theta]i", "[", "i", "]"}]], "+", 
                SubscriptBox["To", 
                 RowBox[{"\[Theta]i", "[", "i", "]"}]], "+", 
                SubscriptBox["Te", 
                 RowBox[{"\[Theta]i", "[", "i", "]"}]]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "max"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"normalincidence", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"dataRp", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", 
              RowBox[{"dataRs", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ")"}], "*", 
            "100"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Column", "\[IndentingNewLine]", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ListLinePlot", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Tooltip", "[", 
                   RowBox[{"dataRp", ",", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<R\>\"", ",", "Italic"}], "]"}], 
                    "\"\<p\>\""]}], "]"}], ",", 
                  RowBox[{"Tooltip", "[", 
                   RowBox[{"dataRs", ",", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<R\>\"", ",", "Italic"}], "]"}], 
                    "\"\<s\>\""]}], "]"}], ",", 
                  RowBox[{"Tooltip", "[", 
                   RowBox[{"dataTo", ",", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<T\>\"", ",", "Italic"}], "]"}], 
                    "\"\<o\>\""]}], "]"}], ",", 
                  RowBox[{"Tooltip", "[", 
                   RowBox[{"dataTe", ",", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<T\>\"", ",", "Italic"}], "]"}], 
                    "\"\<e\>\""]}], "]"}], ",", 
                  RowBox[{"Tooltip", "[", 
                   RowBox[{"dataTotal", ",", "\"\<Total\>\""}], "]"}]}], 
                 "}"}], ",", 
                RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"\[Theta]init", ",", 
                    RowBox[{"\[Theta]init", "+", 
                    RowBox[{"max", " ", "\[CapitalDelta]\[Theta]"}]}]}], 
                    "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
                RowBox[{"FrameLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<angle of incidence (\[Degree])\>\"", ",", 
                   "\"\<power ratios\>\""}], "}"}]}], ",", 
                RowBox[{"PlotLabel", "\[Rule]", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<polarization \>\"", ",", "\[Theta]pol", ",", 
                    "\"\<\[Degree] (from s\[Hyphen]pol.), \>\"", ",", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], "\"\<i\>\""],
                     ",", "\"\< = \>\"", ",", "ni", ",", 
                    RowBox[{"\"\<, \>\"", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], 
                    "\"\<o\>\""]}], ",", "\"\< = \>\"", ",", "no", ",", 
                    "\"\<, \>\"", ",", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], "\"\<e\>\""],
                     ",", "\"\< = \>\"", ",", "ne"}], "}"}], "]"}], " ", ",", 
                   "14"}], "]"}]}], ",", 
                RowBox[{"LabelStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", "13", "]"}]}], ",", 
                RowBox[{"GridLines", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "90", ",", "10"}], "]"}], ",", 
                   "Automatic"}], "}"}]}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Thickness", "[", "0.004", "]"}]}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
                RowBox[{"Epilog", "->", 
                 RowBox[{"Inset", "[", 
                  RowBox[{
                   RowBox[{"Panel", "[", 
                    RowBox[{"Text", "@", 
                    RowBox[{"Grid", "[", 
                    RowBox[{"MapIndexed", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"First", "@", "#2"}]}], "]"}], ",", "Thick", ",", 
                    
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], 
                    ",", 
                    RowBox[{"AspectRatio", "\[Rule]", ".1"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "20"}]}], "]"}], ",", 
                    "#1"}], "}"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<R\>\"", ",", "Italic"}], "]"}], "\"\<p\>\""],
                     ",", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<R\>\"", ",", "Italic"}], "]"}], "\"\<s\>\""],
                     ",", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<T\>\"", ",", "Italic"}], "]"}], "\"\<o\>\""],
                     ",", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<T\>\"", ",", "Italic"}], "]"}], "\"\<e\>\""],
                     ",", "\"\<Total\>\""}], "}"}]}], "]"}], "]"}]}], "]"}], 
                   ",", 
                   RowBox[{"Offset", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.16", ",", "0.9"}], "}"}], "]"}]}], "]"}], ",", 
                   
                   RowBox[{"{", 
                    RowBox[{"Right", ",", "Top"}], "}"}]}], "]"}]}]}], "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Text", "@", 
               RowBox[{
               "If", "\[IndentingNewLine]", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\[Theta]pol", "\[Equal]", "0"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<reflectivity at normal incidence = \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"Round", "[", 
                    RowBox[{"normalincidence", ",", "0.01"}], "]"}], "]"}], 
                    "<>", "\"\< %\>\""}], ",", "13"}], "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", "LightBlue"}]}], "]"}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<Brewster = \>\"", "<>", 
                    RowBox[{"ToString", "[", "brewster", "]"}], "<>", 
                    "\"\<\[Degree]\>\""}], ",", "13"}], "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", "LightBlue"}]}], "]"}], 
                    ",", 
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<reflectivity (0\[Degree]) = \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"Round", "[", " ", 
                    RowBox[{"normalincidence", ",", "0.01"}], "]"}], "]"}], 
                    "<>", "\"\<%\>\""}], ",", "13"}], "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", "LightBlue"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["\"\<TIR\>\"", "\"\<o\>\""], ",", 
                    "\"\< = \>\"", ",", "tiro", ",", "\"\<\[Degree]\>\""}], 
                    "}"}], "]"}], ",", "13"}], "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", "LightBlue"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["\"\<TIR\>\"", "\"\<e\>\""], ",", 
                    "\"\< = \>\"", ",", "tire", ",", "\"\<\[Degree]\>\""}], 
                    "}"}], "]"}], ",", "13"}], "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", "LightBlue"}]}], "]"}]}],
                    "\[IndentingNewLine]", "}"}], "]"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], " ", 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"datarp", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Theta]i", "[", "i", "]"}], ",", 
               RowBox[{"Abs", "[", 
                SubscriptBox["rp", 
                 RowBox[{"\[Theta]i", "[", "i", "]"}]], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "max"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"datars", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Theta]i", "[", "i", "]"}], ",", 
               RowBox[{"Abs", "[", 
                SubscriptBox["rs", 
                 RowBox[{"\[Theta]i", "[", "i", "]"}]], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "max"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"datato", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Theta]i", "[", "i", "]"}], ",", 
               RowBox[{"Abs", "[", 
                SubscriptBox["to", 
                 RowBox[{"\[Theta]i", "[", "i", "]"}]], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "max"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"datate", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Theta]i", "[", "i", "]"}], ",", 
               RowBox[{"Abs", "[", 
                SubscriptBox["te", 
                 RowBox[{"\[Theta]i", "[", "i", "]"}]], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "max"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"phaserp", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Theta]i", "[", "i", "]"}], ",", 
               RowBox[{
                FractionBox["1", "\[Pi]"], 
                RowBox[{"Arg", "[", 
                 RowBox[{"Chop", "[", 
                  SubscriptBox["rp", 
                   RowBox[{"\[Theta]i", "[", "i", "]"}]], "]"}], "]"}]}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "max"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"phasers", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Theta]i", "[", "i", "]"}], ",", 
               RowBox[{
                FractionBox["1", "\[Pi]"], 
                RowBox[{"Arg", "[", 
                 RowBox[{"Chop", "[", 
                  SubscriptBox["rs", 
                   RowBox[{"\[Theta]i", "[", "i", "]"}]], "]"}], "]"}]}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "max"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"plot", "==", "\"\<Fresnel (r, t)\>\""}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"ListLinePlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Tooltip", "[", 
                 RowBox[{"datarp", ",", 
                  SubscriptBox[
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<r\>\"", ",", "Italic"}], "]"}], 
                   "\"\<p\>\""]}], "]"}], ",", 
                RowBox[{"Tooltip", "[", 
                 RowBox[{"datars", ",", 
                  SubscriptBox[
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<r\>\"", ",", "Italic"}], "]"}], 
                   "\"\<s\>\""]}], "]"}], ",", 
                RowBox[{"Tooltip", "[", 
                 RowBox[{"datato", ",", 
                  SubscriptBox[
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<t\>\"", ",", "Italic"}], "]"}], 
                   "\"\<o\>\""]}], "]"}], ",", 
                RowBox[{"Tooltip", "[", 
                 RowBox[{"datate", ",", 
                  SubscriptBox[
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<t\>\"", ",", "Italic"}], "]"}], 
                   "\"\<e\>\""]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]",
               "\t\t", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\[Theta]init", ",", 
                   RowBox[{"\[Theta]init", "+", 
                    RowBox[{"max", " ", "\[CapitalDelta]\[Theta]"}]}]}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                "\"\<angle of incidence (\[Degree])\>\"", ",", 
                 "\"\<Fresnel amplitudes (Abs)\>\""}], "}"}]}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"PlotLabel", "\[Rule]", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<polarization \>\"", ",", "\[Theta]pol", ",", 
                    "\"\<\[Degree] (from s\[Hyphen]pol.), \>\"", ",", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], "\"\<i\>\""],
                     ",", "\"\< = \>\"", ",", "ni", ",", 
                    RowBox[{"\"\<, \>\"", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], 
                    "\"\<o\>\""]}], ",", "\"\< = \>\"", ",", "no", ",", 
                    "\"\<, \>\"", ",", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], "\"\<e\>\""],
                     ",", "\"\< = \>\"", ",", "ne"}], "}"}], "]"}], " ", ",", 
                 "14"}], "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
              RowBox[{"LabelStyle", "\[Rule]", 
               RowBox[{"Directive", "[", "13", "]"}]}], ",", 
              RowBox[{"GridLines", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Range", "[", 
                  RowBox[{"0", ",", "90", ",", "10"}], "]"}], ",", 
                 "Automatic"}], "}"}]}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"Thickness", "[", "0.004", "]"}]}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Epilog", "->", 
               RowBox[{"Inset", "[", "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{"Panel", "[", 
                  RowBox[{"Text", "@", 
                   RowBox[{"Grid", "[", 
                    RowBox[{"MapIndexed", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"First", "@", "#2"}]}], "]"}], ",", "Thick", ",", 
                    
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], 
                    ",", 
                    RowBox[{"AspectRatio", "\[Rule]", ".1"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "20"}]}], "]"}], ",", 
                    "#1"}], "}"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<r\>\"", ",", "Italic"}], "]"}], "\"\<p\>\""],
                     ",", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<r\>\"", ",", "Italic"}], "]"}], "\"\<s\>\""],
                     ",", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<t\>\"", ",", "Italic"}], "]"}], "\"\<o\>\""],
                     ",", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<t\>\"", ",", "Italic"}], "]"}], 
                    "\"\<e\>\""]}], "}"}]}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"Offset", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.16", ",", "0.9"}], "}"}], "]"}]}], "]"}], ",", 
                 
                 RowBox[{"{", 
                  RowBox[{"Right", ",", "Top"}], "}"}]}], "]"}]}]}], "]"}], 
            "\[IndentingNewLine]", "\t", ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"Column", "\[IndentingNewLine]", "[", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"ListLinePlot", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Tooltip", "[", 
                    RowBox[{"phaserp", ",", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<r\>\"", ",", "Italic"}], "]"}], 
                    "\"\<p\>\""]}], "]"}], ",", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{"phasers", ",", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<r\>\"", ",", "Italic"}], "]"}], 
                    "\"\<s\>\""]}], "]"}]}], "}"}], ",", 
                  RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                  RowBox[{"PlotRange", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "90"}], "}"}], ",", "Automatic"}], 
                    "}"}]}], ",", "\[IndentingNewLine]", "\t", 
                  RowBox[{"FrameLabel", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<angle of incidence (\[Degree])\>\"", ",", 
                    "\"\<phase (\[Pi] radians)\>\""}], "}"}]}], ",", 
                  "\[IndentingNewLine]", "\t", 
                  RowBox[{"PlotLabel", "\[Rule]", 
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<polarization \>\"", ",", "\[Theta]pol", ",", 
                    "\"\<\[Degree] (from s\[Hyphen]pol.), \>\"", ",", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], "\"\<i\>\""],
                     ",", "\"\< = \>\"", ",", "ni", ",", 
                    RowBox[{"\"\<, \>\"", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], 
                    "\"\<o\>\""]}], ",", "\"\< = \>\"", ",", "no", ",", 
                    "\"\<, \>\"", ",", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], "\"\<e\>\""],
                     ",", "\"\< = \>\"", ",", "ne"}], "}"}], "]"}], " ", ",", 
                    "14"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
                  RowBox[{"LabelStyle", "\[Rule]", 
                   RowBox[{"Directive", "[", "13", "]"}]}], ",", 
                  RowBox[{"GridLines", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "90", ",", "10"}], "]"}], ",", 
                    "Automatic"}], "}"}]}], ",", 
                  RowBox[{"PlotStyle", "\[Rule]", 
                   RowBox[{"Thickness", "[", "0.004", "]"}]}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Epilog", "->", 
                   RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"Panel", "[", 
                    RowBox[{"Text", "@", 
                    RowBox[{"Grid", "[", 
                    RowBox[{"MapIndexed", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"First", "@", "#2"}]}], "]"}], ",", "Thick", ",", 
                    
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], 
                    ",", 
                    RowBox[{"AspectRatio", "\[Rule]", ".1"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "20"}]}], "]"}], ",", 
                    "#1"}], "}"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<r\>\"", ",", "Italic"}], "]"}], "\"\<p\>\""],
                     ",", 
                    SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<r\>\"", ",", "Italic"}], "]"}], 
                    "\"\<s\>\""]}], "}"}]}], "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Offset", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.16", ",", "0.9"}], "}"}], "]"}]}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"Right", ",", "Top"}], "}"}]}], "]"}]}]}], "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"Text", "@", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<Brewster = \>\"", "<>", 
                    RowBox[{"ToString", "[", "brewster", "]"}], "<>", 
                    "\"\<\[Degree]\>\""}], ",", "13"}], "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", "LightBlue"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["\"\<TIR\>\"", "\"\<o\>\""], ",", 
                    "\"\< = \>\"", ",", "tiro", ",", "\"\<\[Degree]\>\""}], 
                    "}"}], "]"}], ",", "13"}], "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", "LightBlue"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["\"\<TIR\>\"", "\"\<e\>\""], ",", 
                    "\"\< = \>\"", ",", "tire", ",", "\"\<\[Degree]\>\""}], 
                    "}"}], "]"}], ",", "13"}], "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", "LightBlue"}]}], "]"}]}],
                    "\[IndentingNewLine]", "}"}], "]"}]}]}], 
               "\[IndentingNewLine]", "}"}], ",", 
              RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], 
           "]"}]}]}], " ", "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", ")"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "MAIN"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
, " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"PROGRAM", "--"}], "--"}], "--"}], "--"}], "--"}],
                     "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
               "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
        "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"-", 
           RowBox[{"Snell", "'"}]}]}]}]}]}], "s", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Law", "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
        "--"}], "--"}]}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Theta]inr", "=", 
     RowBox[{"\[Theta]ind", "*", 
      FractionBox["\[Pi]", "180."]}]}], ";", " ", "\[IndentingNewLine]", 
    RowBox[{"\[Theta]or", "=", 
     RowBox[{"ArcSin", "[", 
      FractionBox[
       RowBox[{"ni", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]ind", "*", 
          FractionBox["\[Pi]", "180."]}], "]"}]}], "no"], "]"}]}], ";", " ", 
    RowBox[{"\[Theta]od", "=", 
     RowBox[{
      FractionBox["180.", "\[Pi]"], "\[Theta]or"}]}], ";", 
    RowBox[{"\[Theta]odx", "=", 
     RowBox[{"90.", "-", "\[Theta]od"}]}], ";", " ", 
    RowBox[{"\[Theta]odre", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Theta]od", "\[Element]", "Reals"}], ",", "\[Theta]od", ",", 
       "90."}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"m1", "=", "\[IndentingNewLine]", 
     RowBox[{"FindRoot", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ni", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]ind", "*", 
           FractionBox["\[Pi]", "180."]}], "]"}]}], "==", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"no", "*", "ne"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"\[Sqrt]", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["no", "2"], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["ne", "2"], "-", 
                 SuperscriptBox["no", "2"]}], ")"}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"Sin", "[", "d\[Theta]", "]"}]}], 
                   RowBox[{"Cos", "[", 
                    FractionBox[
                    RowBox[{"\[Pi]", " ", "\[Theta]"}], "180."], "]"}], 
                   RowBox[{"Sin", "[", 
                    FractionBox[
                    RowBox[{"\[Pi]", " ", "Q"}], "180."], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Cos", "[", "d\[Theta]", "]"}], 
                   RowBox[{"Cos", "[", 
                    FractionBox[
                    RowBox[{"Q", "*", "\[Pi]"}], "180."], "]"}], 
                   RowBox[{"Cos", "[", 
                    FractionBox[
                    RowBox[{"\[Pi]", " ", "\[Theta]"}], "180."], "]"}]}]}], 
                 ")"}], "2"]}]}], ")"}]}], ")"}]}], "*", 
         RowBox[{"Sin", "[", "d\[Theta]", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"d\[Theta]", ",", 
         RowBox[{
          FractionBox[
           RowBox[{"Re", "[", "\[Theta]or", "]"}], "2"], "-", 
          RowBox[{
           FractionBox[
            RowBox[{"Re", "[", "\[Theta]or", "]"}], "5"], "I"}]}]}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Theta]er", "=", 
     RowBox[{"Chop", "[", 
      RowBox[{"d\[Theta]", "/.", "m1"}], "]"}]}], ";", " ", 
    RowBox[{"\[Theta]ed", "=", 
     RowBox[{"\[Theta]er", "*", 
      FractionBox["180.", "\[Pi]"]}]}], ";", 
    RowBox[{"\[Theta]edx", "=", 
     RowBox[{"90.", "-", "\[Theta]ed"}]}], ";", 
    RowBox[{"\[Theta]edre", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Theta]ed", "\[Element]", "Reals"}], ",", "\[Theta]ed", ",", 
       "90."}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[CurlyPhi]er", "=", 
     RowBox[{
      RowBox[{"Q", " ", 
       FractionBox["\[Pi]", "180."]}], "+", "\[Theta]er"}]}], ";", 
    RowBox[{"\[CurlyPhi]ed", "=", 
     RowBox[{"\[Theta]ed", "+", "Q"}]}], ";", " ", "\[IndentingNewLine]", 
    RowBox[{"Qx", "=", 
     RowBox[{"90.", "+", "Q"}]}], ";", " ", "\[IndentingNewLine]", 
    RowBox[{"n\[CurlyPhi]", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"no", "*", "ne"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["no", "2"], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["ne", "2"], "-", 
             SuperscriptBox["no", "2"]}], ")"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Sin", "[", "\[Theta]er", "]"}]}], 
               RowBox[{"Cos", "[", 
                FractionBox[
                 RowBox[{"\[Pi]", " ", "\[Theta]"}], "180."], "]"}], 
               RowBox[{"Sin", "[", 
                FractionBox[
                 RowBox[{"\[Pi]", " ", "Q"}], "180."], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]er", "]"}], 
               RowBox[{"Cos", "[", 
                FractionBox[
                 RowBox[{"Q", "*", "\[Pi]"}], "180."], "]"}], 
               RowBox[{"Cos", "[", 
                FractionBox[
                 RowBox[{"\[Pi]", " ", "\[Theta]"}], "180."], "]"}]}]}], 
             ")"}], "2"]}]}], ")"}]}], ")"}]}]}], ";", " ", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"-", "Define"}]}]}]}]}]}], " ", "unit", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vectors", "--"}], "--"}], "--"}], "--"}], "--"}], 
          "--"}], "--"}], "--"}], "--"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"OAx", ",", "OAy", ",", "OAz"}], "}"}], "=", 
     RowBox[{"oa", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", 
         FractionBox[
          RowBox[{"\[Pi]", " ", "\[Theta]"}], "180."], "]"}], ",", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", 
           FractionBox[
            RowBox[{"\[Pi]", " ", "\[Theta]"}], "180."], "]"}]}], 
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"\[Pi]", " ", "Q"}], "180."], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"\[Pi]", " ", "\[Theta]"}], "180."], "]"}], 
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"\[Pi]", " ", "Q"}], "180."], "]"}]}]}], "}"}]}]}], ";", 
    " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"kex", ",", "key", ",", "kez"}], "}"}], "=", 
     RowBox[{"ke", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"Sin", "[", "\[Theta]er", "]"}], ",", 
        RowBox[{"Cos", "[", "\[Theta]er", "]"}]}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"kox", ",", "koy", ",", "koz"}], "}"}], "=", 
     RowBox[{"ko", "=", 
      RowBox[{"So", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Sin", "[", "\[Theta]or", "]"}], ",", 
         RowBox[{"Cos", "[", "\[Theta]or", "]"}]}], "}"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"kix", ",", "kiy", ",", "kiz"}], "}"}], "=", 
     RowBox[{"ki", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"Sin", "[", "\[Theta]inr", "]"}], ",", 
        RowBox[{"Cos", "[", "\[Theta]inr", "]"}]}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"krx", ",", "kry", ",", "krz"}], "}"}], "=", 
     RowBox[{"kr", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"Sin", "[", "\[Theta]inr", "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Theta]inr", "]"}]}]}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", "Evaluate"}]}]}]}]}]}]}], " ", 
      RowBox[{"(", "e", ")"}], " ", "ray", " ", "directional", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"components", " ", "--"}], "--"}], "--"}], "--"}], "--"}],
         "--"}], "--"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xe", ",", "ye", ",", "ze"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"n\[CurlyPhi]", " ", 
        RowBox[{"Sin", "[", "\[Theta]er", "]"}]}], ",", 
       RowBox[{"n\[CurlyPhi]", " ", 
        RowBox[{"Cos", "[", "\[Theta]er", "]"}]}]}], "}"}]}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"xse", "=", 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        SuperscriptBox["ne", "2"], " ", 
        SuperscriptBox["no", "2"]}]], 
      RowBox[{"(", 
       RowBox[{"ne", "-", "no"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"ne", "+", "no"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ze", " ", 
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"\[Pi]", " ", "Q"}], "180."], "]"}]}], "-", 
        RowBox[{"ye", " ", 
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"\[Pi]", " ", "Q"}], "180."], "]"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"\[Pi]", " ", "\[Theta]"}], "90."], "]"}]}]}], ";", 
    RowBox[{"yse", "=", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"4", " ", 
        SuperscriptBox["ne", "2"], " ", 
        SuperscriptBox["no", "2"]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["ne", "2"], " ", "ye"}], "+", 
        RowBox[{"6", " ", 
         SuperscriptBox["no", "2"], " ", "ye"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ne", "-", "no"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"ne", "+", "no"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "ye", " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"\[Pi]", " ", "\[Theta]"}], "90."], "]"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ye", "-", "ze"}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"\[Pi]", " ", "Q"}], "90."], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"Cos", "[", 
               FractionBox[
                RowBox[{"\[Pi]", " ", "\[Theta]"}], "90."], "]"}]}], ")"}]}], 
           "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ye", "+", "ze"}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"\[Pi]", " ", "Q"}], "90."], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"Cos", "[", 
               FractionBox[
                RowBox[{"\[Pi]", " ", "\[Theta]"}], "90."], "]"}]}], ")"}]}], 
           "-", 
           RowBox[{"4", " ", "ze", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{"\[Pi]", " ", "\[Theta]"}], "180."], "]"}], "2"], " ", 
            
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"\[Pi]", " ", "Q"}], "90."], "]"}]}]}], ")"}]}]}], 
       ")"}]}]}], ";", 
    RowBox[{"zse", "=", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"4", " ", 
        SuperscriptBox["ne", "2"], " ", 
        SuperscriptBox["no", "2"]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["ne", "2"], " ", "ze"}], "+", 
        RowBox[{"6", " ", 
         SuperscriptBox["no", "2"], " ", "ze"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ne", "-", "no"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"ne", "+", "no"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "ze", " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"\[Pi]", " ", "\[Theta]"}], "90."], "]"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ye", "-", "ze"}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"\[Pi]", " ", "Q"}], "90."], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"Cos", "[", 
               FractionBox[
                RowBox[{"\[Pi]", " ", "\[Theta]"}], "90."], "]"}]}], ")"}]}], 
           "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ye", "+", "ze"}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"\[Pi]", " ", "Q"}], "90."], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"Cos", "[", 
               FractionBox[
                RowBox[{"\[Pi]", " ", "\[Theta]"}], "90."], "]"}]}], ")"}]}], 
           "-", 
           RowBox[{"4", " ", "ye", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{"\[Pi]", " ", "\[Theta]"}], "180."], "]"}], "2"], " ", 
            
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"\[Pi]", " ", "Q"}], "90."], "]"}]}]}], ")"}]}]}], 
       ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Se", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xSe", ",", "ySe", ",", "zSe"}], "}"}], "=", 
      RowBox[{"Normalize", "[", 
       RowBox[{"{", 
        RowBox[{"xse", ",", "yse", ",", "zse"}], "}"}], "]"}]}]}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Theta]Se", "=", 
     RowBox[{"VectorAngle", "[", 
      RowBox[{"Se", ",", 
       RowBox[{"{", 
        RowBox[{"0.", ",", "0.", ",", "1."}], "}"}]}], "]"}]}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"plane", "=", 
     RowBox[{"Det", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Re", "[", "kex", "]"}], ",", 
          RowBox[{"Re", "[", "key", "]"}], ",", 
          RowBox[{"Re", "[", "kez", "]"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"OAx", ",", "OAy", ",", "OAz", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Re", "[", "xSe", "]"}], ",", 
          RowBox[{"Re", "[", "ySe", "]"}], ",", 
          RowBox[{"Re", "[", "zSe", "]"}], ",", "1"}], "}"}]}], "}"}], 
      "]"}]}], ";", " ", "\[IndentingNewLine]", 
    RowBox[{"\[Theta]s", "=", 
     RowBox[{"VectorAngle", "[", 
      RowBox[{"ke", ",", "Se"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
    RowBox[{"nS", "=", 
     RowBox[{"n\[CurlyPhi]", " ", 
      RowBox[{"Cos", "[", "\[Theta]s", "]"}]}]}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"slope2", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"yse", "\[Equal]", "0"}], ",", "\[Infinity]", ",", 
       RowBox[{"Re", "[", 
        RowBox[{"zse", "/", "yse"}], "]"}]}], "]"}]}], ";", 
    RowBox[{"\[Theta]Phor", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"slope2", ">", "0"}], ",", 
       RowBox[{
        FractionBox["180.", "\[Pi]"], 
        RowBox[{"ArcTan", "[", "slope2", "]"}]}], ",", 
       RowBox[{
        FractionBox["180.", "\[Pi]"], "*", 
        RowBox[{"(", 
         RowBox[{"\[Pi]", "+", 
          RowBox[{"ArcTan", "[", "slope2", "]"}]}], ")"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Theta]Pre", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Theta]Phor", "\[Element]", "Reals"}], ",", "\[Theta]Phor", 
       ",", "90."}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", "Fresnel"}]}]}]}]}]}]}], " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"equations", " ", "--"}], "--"}], "--"}], "--"}], "--"}], 
        "--"}], "--"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"kip", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Cos", "[", "\[Theta]inr", "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Theta]inr", "]"}]}]}], "}"}]}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"krp", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        RowBox[{"Cos", "[", "\[Theta]inr", "]"}]}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Theta]inr", "]"}]}]}], "}"}]}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Einc", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]pol", "*", 
         FractionBox["\[Pi]", "180."]}], "]"}], " ", 
       RowBox[{"{", 
        RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]pol", "*", 
         FractionBox["\[Pi]", "180."]}], "]"}], "kip"}]}]}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Eref", "=", 
     RowBox[{
      RowBox[{"rs", " ", 
       RowBox[{"{", 
        RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}], "+", 
      RowBox[{"rp", " ", "krp"}]}]}], ";", " ", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]", "\[Equal]", "0"}], "\[Or]", 
       RowBox[{"no", "\[Equal]", "ne"}]}], ",", 
      RowBox[{"dirEord", "=", 
       RowBox[{"{", 
        RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}], ",", 
      RowBox[{"dirEord", "=", 
       RowBox[{"Normalize", "[", 
        RowBox[{"Cross", "[", 
         RowBox[{"ko", ",", "oa"}], "]"}], "]"}]}]}], "]"}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Eord", "=", 
     RowBox[{"to", " ", "dirEord"}]}], ";", " ", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Q", "\[Equal]", "0"}], "&&", 
        RowBox[{"\[Theta]ind", "\[Equal]", "0"}], "&&", 
        RowBox[{"\[Theta]", "\[Equal]", "0"}]}], "\[Or]", 
       RowBox[{"no", "\[Equal]", "ne"}]}], ",", 
      RowBox[{"dirEext", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Cos", "[", "\[Theta]er", "]"}], ",", 
         RowBox[{"-", 
          RowBox[{"Sin", "[", "\[Theta]er", "]"}]}]}], "}"}]}], ",", 
      RowBox[{"dirEext", "=", 
       RowBox[{"Normalize", "[", 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{"ke", ",", "oa"}], "]"}], ",", "Se"}], "]"}], "]"}]}]}], 
     "]"}], ";", " ", "\[IndentingNewLine]", 
    RowBox[{"Eext", "=", 
     RowBox[{"te", " ", "dirEext"}]}], ";", " ", "\[IndentingNewLine]", 
    RowBox[{"Hinc", "=", 
     RowBox[{"ni", " ", 
      RowBox[{"Cross", "[", 
       RowBox[{"ki", ",", "Einc"}], "]"}]}]}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Href", "=", 
     RowBox[{"ni", " ", 
      RowBox[{"Cross", "[", 
       RowBox[{"kr", ",", "Eref"}], "]"}]}]}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Hord", "=", 
     RowBox[{"no", " ", 
      RowBox[{"Cross", "[", 
       RowBox[{"ko", ",", "Eord"}], "]"}]}]}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Hext", "=", 
     RowBox[{"n\[CurlyPhi]", " ", 
      RowBox[{"Cross", "[", 
       RowBox[{"ke", ",", "Eext"}], "]"}]}]}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"fresnel", "=", 
     RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
      RowBox[{"Solve", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Einc", "+", "Eref"}], ")"}], ".", 
            RowBox[{"{", 
             RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}], "\[Equal]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Eord", "+", "Eext"}], ")"}], ".", 
            RowBox[{"{", 
             RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Einc", "+", "Eref"}], ")"}], ".", 
            RowBox[{"{", 
             RowBox[{"0.", ",", "1.", ",", "0."}], "}"}]}], "\[Equal]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Eord", "+", "Eext"}], ")"}], ".", 
            RowBox[{"{", 
             RowBox[{"0.", ",", "1.", ",", "0."}], "}"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Hinc", "+", "Href"}], ")"}], ".", 
            RowBox[{"{", 
             RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}], "\[Equal]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Hord", "+", "Hext"}], ")"}], ".", 
            RowBox[{"{", 
             RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Hinc", "+", "Href"}], ")"}], ".", 
            RowBox[{"{", 
             RowBox[{"0.", ",", "1.", ",", "0."}], "}"}]}], "\[Equal]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Hord", "+", "Hext"}], ")"}], ".", 
            RowBox[{"{", 
             RowBox[{"0.", ",", "1.", ",", "0."}], "}"}]}]}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"rs", ",", "rp", ",", "to", ",", "te"}], "}"}]}], "]"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"temprs", "=", 
     RowBox[{"fresnel", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
    RowBox[{"temprp", "=", 
     RowBox[{"fresnel", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", 
    RowBox[{"tempto", "=", 
     RowBox[{"fresnel", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ";", 
    RowBox[{"tempte", "=", 
     RowBox[{"fresnel", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"tempRp", "=", 
     RowBox[{"Chop", "[", 
      RowBox[{"temprp", " ", 
       RowBox[{"temprp", "\[Conjugate]"}]}], "]"}]}], ";", 
    RowBox[{"tempRs", "=", 
     RowBox[{"Chop", "[", 
      RowBox[{"temprs", " ", 
       RowBox[{"temprs", "\[Conjugate]"}]}], "]"}]}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"tempTo", "=", 
     RowBox[{"Chop", "[", 
      RowBox[{"Re", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"no", " ", 
          RowBox[{"Cos", "[", "\[Theta]or", "]"}]}], 
         RowBox[{"ni", " ", 
          RowBox[{"Cos", "[", "\[Theta]inr", "]"}]}]], " ", "tempto", " ", 
        RowBox[{"tempto", "\[Conjugate]"}]}], "]"}], "]"}]}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"tempTe", "=", 
     RowBox[{"Chop", "[", 
      RowBox[{"Re", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"nS", " ", 
          RowBox[{"Cos", "[", "\[Theta]Se", "]"}]}], 
         RowBox[{"ni", " ", 
          RowBox[{"Cos", "[", "\[Theta]inr", "]"}]}]], "tempte", " ", 
        RowBox[{"tempte", "\[Conjugate]"}]}], "]"}], "]"}]}], ";", " ", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", "END"}]}]}]}]}]}]}]}]}]}]}]}]}], " ", "OF", 
       " ", "MAIN", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"PROGRAM", "--"}], "--"}], "--"}], "--"}], "--"}], 
              "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}]}], "-"}],
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Information", " ", "data", " ", "in", " ", "grid", " ", "form"}], " ", 
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"info", ":=", "\[IndentingNewLine]", 
     RowBox[{"Text", "@", 
      RowBox[{"Grid", "[", 
       RowBox[{"{", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Grid", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{"\"\<refracted \>\"", ",", " ", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<k\>\"", ",", "Italic"}], "]"}], ",", " ", 
                    "\"\<o\>\""}], "]"}]}], "}"}], "]"}], ",", 
                RowBox[{"\[Theta]od", "\"\<\[Degree]\>\""}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{"\"\<refracted \>\"", ",", " ", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<k\>\"", ",", "Italic"}], "]"}], ",", " ", 
                    "\"\<e\>\""}], "]"}]}], "}"}], "]"}], ",", 
                RowBox[{"\[Theta]ed", "\"\<\[Degree]\>\""}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{"\"\<index \>\"", ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                   "\"\<(\>\"", ",", " ", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<k\>\"", ",", "Italic"}], "]"}], ",", " ", 
                    "\"\<e\>\""}], "]"}], ",", "\"\<)\>\""}], "}"}], "]"}], 
                ",", 
                RowBox[{"Chop", "[", "n\[CurlyPhi]", "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<OA unit vector\\n\>\"", ",", 
                RowBox[{"Chop", "[", "oa", "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<k\>\"", ",", "Italic"}], "]"}], ",", " ", 
                    "\"\<inc\>\""}], "]"}], ",", "\"\< unit vector \>\""}], 
                  "}"}], "]"}], ",", 
                RowBox[{"Chop", "[", "ki", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<k\>\"", ",", "Italic"}], "]"}], ",", " ", 
                    "\"\<ref\>\""}], "]"}], ",", "\"\< unit vector \>\""}], 
                  "}"}], "]"}], ",", 
                RowBox[{"Chop", "[", "kr", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<k\>\"", ",", "Italic"}], "]"}], ",", " ", 
                    "\"\<o\>\""}], "]"}], ",", "\"\< unit vector \>\""}], 
                  "}"}], "]"}], ",", 
                RowBox[{"Chop", "[", "ko", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<k\>\"", ",", "Italic"}], "]"}], ",", " ", 
                    "\"\<e\>\""}], "]"}], ",", "\"\< unit vector \>\""}], 
                  "}"}], "]"}], ",", 
                RowBox[{"Chop", "[", "ke", "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<S\>\"", ",", "Italic"}], "]"}], ",", " ", 
                    "\"\<e\>\""}], "]"}], ",", "\"\< unit vector\\n \>\""}], 
                  "}"}], "]"}], ",", 
                RowBox[{"Chop", "[", "Se", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{"\"\<plane of \>\"", ",", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<k\>\"", ",", "Italic"}], "]"}], ",", " ", 
                    "\"\<e\>\""}], "]"}], ",", 
                   RowBox[{"\"\<, \>\"", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<S\>\"", ",", "Italic"}], "]"}], ",", " ", 
                    "\"\<e\>\""}], "]"}]}], ",", 
                   "\"\< \\nand OA vectors \>\""}], "}"}], "]"}], ",", 
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{"TraditionalForm", "@", 
                   RowBox[{"Simplify", "[", 
                    RowBox[{"Chop", "[", 
                    RowBox[{"plane", "\[Equal]", "0"}], "]"}], "]"}]}], "}"}],
                  "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{"Subscript", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<E\>\"", ",", "Bold"}], "]"}], ",", " ", 
                    "\"\<inc\>\""}], "]"}], "}"}], "]"}], ",", 
                RowBox[{"Chop", "[", "Einc", "]"}]}], "}"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Alignment", "\[Rule]", "Left"}], ",", 
            RowBox[{"Frame", "\[Rule]", "All"}], ",", 
            RowBox[{"Spacings", "\[Rule]", "0.5"}], ",", 
            RowBox[{"ItemSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"9", ",", "15"}], "}"}], ",", "1.5"}], "}"}]}], ",", 
            RowBox[{"ItemStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"FontSize", "\[Rule]", "13"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Grid", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<k\>\"", ",", "Italic"}], "]"}], ",", " ", 
                    "\"\<e\>\""}], "]"}], ",", 
                   RowBox[{"\"\<, \>\"", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<S\>\"", ",", "Italic"}], "]"}], ",", " ", 
                    "\"\<e\>\""}], "]"}]}], ",", "\"\< angle\>\""}], "}"}], 
                 "]"}], ",", 
                RowBox[{
                 RowBox[{"Chop", "[", 
                  RowBox[{"\[Theta]s", 
                   FractionBox["180.", "\[Pi]"]}], "]"}], 
                 "\"\<\[Degree]\>\""}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{"\"\<index \>\"", ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                   "\"\<(\>\"", ",", " ", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<S\>\"", ",", "Italic"}], "]"}], ",", " ", 
                    "\"\<e\>\""}], "]"}], ",", "\"\<)\>\""}], "}"}], "]"}], 
                ",", 
                RowBox[{"Chop", "[", "nS", "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<r\>\"", ",", "Italic"}], "]"}], "\"\<s\>\""],
                    ",", "\"\<, \>\"", ",", 
                   SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<r\>\"", ",", "Italic"}], "]"}], 
                    "\"\<p\>\""]}], "}"}], "]"}], ",", 
                RowBox[{"Chop", "[", 
                 RowBox[{"{", 
                  RowBox[{"temprs", ",", "temprp"}], "}"}], "]"}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<t\>\"", ",", "Italic"}], "]"}], "\"\<o\>\""],
                    ",", "\"\<, \>\"", ",", 
                   SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<t\>\"", ",", "Italic"}], "]"}], 
                    "\"\<e\>\""]}], "}"}], "]"}], ",", 
                RowBox[{"Chop", "[", 
                 RowBox[{"{", 
                  RowBox[{"tempto", ",", "tempte"}], "}"}], "]"}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<R\>\"", ",", "Italic"}], "]"}], "\"\<s\>\""],
                    ",", "\"\<, \>\"", ",", 
                   SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<R\>\"", ",", "Italic"}], "]"}], 
                    "\"\<p\>\""]}], "}"}], "]"}], ",", 
                RowBox[{"Chop", "[", 
                 RowBox[{"{", 
                  RowBox[{"tempRs", ",", "tempRp"}], "}"}], "]"}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<T\>\"", ",", "Italic"}], "]"}], "\"\<o\>\""],
                    ",", "\"\<, \>\"", ",", 
                   SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<T\>\"", ",", "Italic"}], "]"}], "\"\<e\>\""],
                    ",", "\"\<, \>\"", ",", "\"\<Total\>\""}], "}"}], "]"}], 
                ",", 
                RowBox[{"Chop", "[", 
                 RowBox[{"{", 
                  RowBox[{"tempTo", ",", "tempTe", ",", 
                   RowBox[{
                   "tempRs", "+", "tempRp", "+", "tempTo", "+", "tempTe"}]}], 
                  "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{"Subscript", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<E\>\"", ",", "Bold"}], "]"}], ",", " ", 
                    "\"\<ref\>\""}], "]"}], "}"}], "]"}], ",", 
                RowBox[{"Round", "[", 
                 RowBox[{
                  RowBox[{"Chop", "[", 
                   RowBox[{"Eref", "/.", "fresnel"}], "]"}], ",", 
                  "0.000001"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{"Subscript", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<E\>\"", ",", "Bold"}], "]"}], ",", " ", 
                    "\"\<o\>\""}], "]"}], "}"}], "]"}], ",", 
                RowBox[{"Round", "[", 
                 RowBox[{
                  RowBox[{"Chop", "[", 
                   RowBox[{"Eord", "/.", "fresnel"}], "]"}], ",", 
                  "0.000001"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{"Subscript", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<E\>\"", ",", "Bold"}], "]"}], ",", " ", 
                    "\"\<e\>\""}], "]"}], "}"}], "]"}], ",", 
                RowBox[{"Round", "[", 
                 RowBox[{
                  RowBox[{"Chop", "[", 
                   RowBox[{"Eext", "/.", "fresnel"}], "]"}], ",", 
                  "0.000001"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{"Subscript", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<H\>\"", ",", "Bold"}], "]"}], ",", " ", 
                    "\"\<inc\>\""}], "]"}], "}"}], "]"}], ",", 
                RowBox[{"Round", "[", 
                 RowBox[{
                  RowBox[{"Chop", "[", 
                   RowBox[{"Hinc", "/.", "fresnel"}], "]"}], ",", 
                  "0.000001"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{"Subscript", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<H\>\"", ",", "Bold"}], "]"}], ",", " ", 
                    "\"\<ref\>\""}], "]"}], "}"}], "]"}], ",", 
                RowBox[{"Round", "[", 
                 RowBox[{
                  RowBox[{"Chop", "[", 
                   RowBox[{"Href", "/.", "fresnel"}], "]"}], ",", 
                  "0.000001"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{"Subscript", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<H\>\"", ",", "Bold"}], "]"}], ",", " ", 
                    "\"\<o\>\""}], "]"}], "}"}], "]"}], ",", 
                RowBox[{"Round", "[", 
                 RowBox[{
                  RowBox[{"Chop", "[", 
                   RowBox[{"Hord", "/.", "fresnel"}], "]"}], ",", 
                  "0.000001"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{"Subscript", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<H\>\"", ",", "Bold"}], "]"}], ",", " ", 
                    "\"\<e\>\""}], "]"}], "}"}], "]"}], ",", 
                RowBox[{"Round", "[", 
                 RowBox[{
                  RowBox[{"Chop", "[", 
                   RowBox[{"Hext", "/.", "fresnel"}], "]"}], ",", 
                  "0.000001"}], "]"}]}], "}"}]}], "}"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Alignment", "\[Rule]", "Left"}], ",", 
            RowBox[{"Spacings", "\[Rule]", "0.5"}], ",", 
            RowBox[{"Frame", "\[Rule]", "All"}], ",", 
            RowBox[{"ItemSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"7", ",", "20"}], "}"}], ",", "1.5"}], "}"}]}], ",", 
            RowBox[{"ItemStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"FontSize", "\[Rule]", "12"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], 
        "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Graphics", " ", "for", " ", "2", "D", " ", "k"}], "\[Hyphen]", 
      
      RowBox[{
      "surfaces", " ", "projected", " ", "on", " ", "the", " ", "plane", " ", 
       "of", " ", "incidence"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"surfaces", ":=", "\[IndentingNewLine]", 
     RowBox[{"ContourPlot", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{"4", " ", 
             SuperscriptBox["ne", "2"], " ", 
             SuperscriptBox["no", "2"]}]], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["ne", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}]}], "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["no", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ne", "-", "no"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"ne", "+", "no"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["y", "2"], "+", 
                   SuperscriptBox["z", "2"]}], ")"}], " ", 
                 RowBox[{"Cos", "[", 
                  FractionBox[
                   RowBox[{"\[Pi]", " ", "\[Theta]"}], "90."], "]"}]}], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"y", "-", "z"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"y", "+", "z"}], ")"}], " ", 
                 RowBox[{"Cos", "[", 
                  FractionBox[
                   RowBox[{"\[Pi]", " ", "Q"}], "90."], "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"Cos", "[", 
                    FractionBox[
                    RowBox[{"\[Pi]", " ", "\[Theta]"}], "90."], "]"}]}], 
                  ")"}]}], "-", 
                RowBox[{"4", " ", "y", " ", "z", " ", 
                 SuperscriptBox[
                  RowBox[{"Cos", "[", 
                   FractionBox[
                    RowBox[{"\[Pi]", " ", "\[Theta]"}], "180."], "]"}], "2"], 
                 " ", 
                 RowBox[{"Sin", "[", 
                  FractionBox[
                   RowBox[{"\[Pi]", " ", "Q"}], "90."], "]"}]}]}], ")"}]}]}], 
            ")"}]}], "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], "\[Equal]", 
          SuperscriptBox["no", "2"]}], ",", 
         RowBox[{"z", "\[Equal]", 
          RowBox[{
           RowBox[{"Tan", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Q", "+", "90"}], ")"}], " ", 
             FractionBox["\[Pi]", "180."]}], "]"}], "y"}]}], ",", 
         RowBox[{"y", "\[Equal]", "0"}], ",", 
         RowBox[{"z", "\[Equal]", "0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"-", "2.5"}], ",", "2.5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{"-", ".02"}], ",", "2.5"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", "12", "}"}]}], ",", 
       RowBox[{"PerformanceGoal", "\[Rule]", 
        RowBox[{"{", "\"\<Quality\>\"", "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<2D \>\"", ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<k\>\"", ",", "Italic"}], "]"}], ",", 
             "\"\<\[Hyphen]surface projection on plane of incidence\>\""}], 
            "}"}], "]"}], ",", "12"}], "]"}]}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "540"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"1", "/", "GoldenRatio"}]}], ",", 
       RowBox[{"Background", "\[Rule]", "LightCyan"}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.15", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Inset", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<interface\>\"", ",", "12", ",", "Black"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "0.5"}], ",", 
              RowBox[{"-", "0.1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Inset", "[", 
           RowBox[{
            RowBox[{"Panel", "[", 
             RowBox[{"Text", "@", 
              RowBox[{"Grid", "[", 
               RowBox[{"MapIndexed", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"First", "@", "#2"}]}], "]"}], ",", "Thick", ",", 
                    
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], 
                    ",", 
                    RowBox[{"AspectRatio", "\[Rule]", ".1"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "20"}]}], "]"}], ",", 
                    "#1"}], "}"}], "&"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<k\>\"", ",", "Italic"}], "]"}], "\"\<e\>\""],
                    ",", 
                   SubscriptBox[
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<k\>\"", ",", "Italic"}], "]"}], "\"\<o\>\""],
                    ",", "\"\<OA\>\"", ",", "\"\<normal\>\""}], "}"}]}], 
                "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"Offset", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "20"}], ",", 
                RowBox[{"-", "2"}]}], "}"}], ",", 
              RowBox[{"Scaled", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"Right", ",", "Top"}], "}"}]}], "]"}]}], "}"}]}], ",", 
       RowBox[{"ContourStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"ColorData", "[", 
             RowBox[{"1", ",", "1"}], "]"}], ",", 
            RowBox[{"Thickness", "[", "0.004", "]"}]}], "]"}], ",", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"ColorData", "[", 
             RowBox[{"1", ",", "2"}], "]"}], ",", 
            RowBox[{"Thickness", "[", "0.004", "]"}]}], "]"}], ",", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"ColorData", "[", 
             RowBox[{"1", ",", "3"}], "]"}], ",", 
            RowBox[{"Thickness", "[", "0.006", "]"}], ",", "Dashed"}], "]"}], 
          ",", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"ColorData", "[", 
             RowBox[{"1", ",", "4"}], "]"}], ",", 
            RowBox[{"Thickness", "[", "0.008", "]"}], ",", "Dashed"}], "]"}], 
          ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Thick"}], "]"}]}], "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Graphics", " ", "for", " ", "vectors", " ", "on", " ", "the", " ", 
      "plane", " ", "of", " ", "incidence"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"vectors", ":=", "\[IndentingNewLine]", 
     RowBox[{"Column", "\[IndentingNewLine]", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Text", "@", 
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<Incident, reflected, and transmitted directions. \>\"", ",", 
            "12"}], "]"}]}], ",", 
         RowBox[{"Text", "@", 
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<Keep OA in the plane of incidence (no elevation). No TIR \
phenomena.\>\"", ",", "12"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LightCyan", ",", 
               RowBox[{"Polygon", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.3"}], ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"1.3", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"1.3", ",", "1.3"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.3"}], ",", "1.3"}], "}"}]}], "}"}], 
                "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
               RowBox[{"Arrowheads", "[", "Large", "]"}], ",", 
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]ind"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]ind"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
               RowBox[{"Circle", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "0.8"}], 
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]ind"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"-", "0.8"}], 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]ind"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}], "}"}], ",", 
                 "0.04"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Red", ",", 
               RowBox[{"PointSize", "[", "0.015", "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "0.8"}], 
                   RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]ind"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"-", "0.8"}], 
                   RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]ind"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}], "}"}], "]"}]}],
               "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", 
               RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
               RowBox[{"Arrowheads", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "0.03"}], ",", "0.03"}], "}"}], "]"}], ",", 
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.7"}], 
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90", "-", "\[Theta]ind"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], "+", 
                    RowBox[{"0.1", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]ind", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.7"}], 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]ind"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], "+", 
                    RowBox[{"0.1", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]ind", 
                    FractionBox["\[Pi]", "180."]}], "]"}], 
                    RowBox[{"Tan", "[", 
                    RowBox[{
                    RowBox[{"-", "\[Theta]ind"}], 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.7"}], 
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]ind"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], "-", 
                    RowBox[{"0.1", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]ind", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.7"}], 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]ind"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], "-", 
                    RowBox[{"0.1", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]ind", 
                    FractionBox["\[Pi]", "180."]}], "]"}], 
                    RowBox[{"Tan", "[", 
                    RowBox[{
                    RowBox[{"-", "\[Theta]ind"}], 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}]}], "}"}]}], 
                 "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
               RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
               RowBox[{"Arrowheads", "[", "Large", "]"}], ",", 
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]ind"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]ind"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}], "}"}]}], "}"}],
                 "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
               RowBox[{"Circle", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"0.7", 
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]ind"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"-", "0.7"}], 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]ind"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}], "}"}], ",", 
                 "0.04"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Red", ",", 
               RowBox[{"PointSize", "[", "0.015", "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.7", 
                   RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]ind"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"-", "0.7"}], 
                   RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]ind"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}], "}"}], "]"}]}],
               "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", 
               RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
               RowBox[{"Arrowheads", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "0.03"}], ",", "0.03"}], "}"}], "]"}], ",", 
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"0.6", 
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90", "-", "\[Theta]ind"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], "+", 
                    RowBox[{"0.1", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]ind", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.6"}], 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]ind"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], "-", 
                    RowBox[{"0.1", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]ind", 
                    FractionBox["\[Pi]", "180."]}], "]"}], 
                    RowBox[{"Tan", "[", 
                    RowBox[{
                    RowBox[{"-", "\[Theta]ind"}], 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"0.6", 
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]ind"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], "-", 
                    RowBox[{"0.1", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]ind", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.6"}], 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]ind"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], "+", 
                    RowBox[{"0.1", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]ind", 
                    FractionBox["\[Pi]", "180."]}], "]"}], 
                    RowBox[{"Tan", "[", 
                    RowBox[{
                    RowBox[{"-", "\[Theta]ind"}], 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}]}], "}"}]}], 
                 "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"Thickness", "[", "0.004", "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.3"}], ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"1.3", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
               RowBox[{"Arrowheads", "[", "Large", "]"}], ",", 
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"1.2", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]odre"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}], ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]odre"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], "}"}]}]}], "}"}],
                 "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
               RowBox[{"Circle", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"0.9", 
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]odre"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], ",", 
                   RowBox[{"0.9", 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]odre"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}], "}"}], ",", 
                 "0.04"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Red", ",", 
               RowBox[{"PointSize", "[", "0.015", "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.9", 
                   RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]odre"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], ",", 
                  RowBox[{"0.9", 
                   RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]odre"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}], "}"}], "]"}]}],
               "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", 
               RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
               RowBox[{"Arrowheads", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "0.03"}], ",", "0.03"}], "}"}], "]"}], ",", 
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"0.8", 
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]edre"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], "+", 
                    RowBox[{"0.1", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]edre", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"0.8", 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]edre"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], "+", 
                    RowBox[{"0.1", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]edre", 
                    FractionBox["\[Pi]", "180."]}], "]"}], 
                    RowBox[{"Tan", "[", 
                    RowBox[{
                    RowBox[{"-", "\[Theta]edre"}], 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"0.8", 
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]edre"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], "-", 
                    RowBox[{"0.1", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]edre", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"0.8", 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]edre"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], "-", 
                    RowBox[{"0.1", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]edre", 
                    FractionBox["\[Pi]", "180."]}], "]"}], 
                    RowBox[{"Tan", "[", 
                    RowBox[{
                    RowBox[{"-", "\[Theta]edre"}], 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}]}], "}"}]}], 
                 "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", 
               RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
               RowBox[{"Arrowheads", "[", "Large", "]"}], ",", 
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"1.2", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]edre"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}], ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]edre"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], "}"}]}]}], "}"}],
                 "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Orange", ",", 
               RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
               RowBox[{"Arrowheads", "[", "Large", "]"}], ",", 
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"1.2", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]Pre", 
                    FractionBox["\[Pi]", "180."]}], "]"}], ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]Pre", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], "}"}]}]}], "}"}],
                 "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Magenta", ",", 
               RowBox[{"Thickness", "[", "0.006", "]"}], ",", "Dashed", ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"1.2", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1.1", 
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "+", "Q"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], ",", 
                    RowBox[{"1.1", 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "+", "Q"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}], "}"}]}]}], 
                 "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Brown", ",", "Dashed", ",", 
               RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1.3"}], "}"}]}], "}"}], "]"}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"Inset", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 SubscriptBox[
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<k\>\"", ",", "Italic"}], "]"}], 
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<o\>\"", ",", "Plain"}], "]"}]], ",", "17", 
                 ",", "Red"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1.25", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]odre"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], ",", 
                 RowBox[{"1.25", 
                  RowBox[{"Sin", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]odre"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}], "}"}]}], "]"}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"Inset", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 SubscriptBox[
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<k\>\"", ",", "Italic"}], "]"}], 
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<e\>\"", ",", "Plain"}], "]"}]], ",", "17", 
                 ",", "Blue"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1.25", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]edre"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], ",", 
                 RowBox[{"1.25", 
                  RowBox[{"Sin", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "-", "\[Theta]edre"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}], "}"}]}], "]"}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"Inset", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 SubscriptBox[
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<S\>\"", ",", "Italic"}], "]"}], 
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<e\>\"", ",", "Plain"}], "]"}]], ",", "17", 
                 ",", "Orange"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1.25", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"\[Theta]Pre", 
                    FractionBox["\[Pi]", "180"]}], "]"}]}], ",", 
                 RowBox[{"1.25", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"\[Theta]Pre", 
                    FractionBox["\[Pi]", "180"]}], "]"}]}]}], "}"}]}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"Inset", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<OA\>\"", ",", "16", ",", "Magenta"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1.1", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90.", "+", "Q"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}], ",", 
                 RowBox[{"1.1", 
                  RowBox[{"Sin", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"90", "+", "Q"}], ")"}], " ", 
                    FractionBox["\[Pi]", "180."]}], "]"}]}]}], "}"}]}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1.3"}], ",", "1.3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1.3"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{".95", 
             RowBox[{"{", 
              RowBox[{"540", ",", "350"}], "}"}]}]}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "5"}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"FrameTicks", "->", "None"}]}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Alignment", "\[Rule]", "Center"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Selection", " ", "index", " ", "for", " ", "graphics"}], " ", 
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Pane", "[", 
     RowBox[{
      RowBox[{"Switch", "\[IndentingNewLine]", "[", "\[IndentingNewLine]", 
       RowBox[{
       "plot", ",", "\[IndentingNewLine]", "\"\<data\>\"", ",", "info", ",", 
        "\[IndentingNewLine]", "\"\<2D k\[Hyphen]surfaces\>\"", ",", 
        "surfaces", ",", "\[IndentingNewLine]", "\"\<2D vectors\>\"", ",", 
        "vectors", ",", "\[IndentingNewLine]", "\"\<Fresnel (r, t)\>\"", ",", 
        "power", ",", "\[IndentingNewLine]", "\"\<phases\>\"", ",", "power", 
        ",", "\[IndentingNewLine]", "\"\<Fresnel (R, T)\>\"", ",", "power"}], 
       "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"600", ",", "375"}], "}"}]}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Control", " ", "variables", " ", "for", " ", "Manipulate"}], " ",
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Grid", "\[IndentingNewLine]", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"plot", ",", "\"\<2D vectors\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<data\>\"", ",", "\"\<2D k\[Hyphen]surfaces\>\"", ",", 
              "\"\<2D vectors\>\"", ",", "\"\<Fresnel (r, t)\>\"", ",", 
              "\"\<phases\>\"", ",", "\"\<Fresnel (R, T)\>\""}], "}"}], ",", 
            RowBox[{"ControlType", "\[Rule]", "RadioButton"}]}], "}"}], "]"}],
          ",", "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Grid", "[", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ni", ",", "1.0", ",", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<index \>\"", ",", " ", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<n\>\"", ",", " ", "\"\<i\>\""}], "]"}]}], 
                    "}"}], "]"}]}], "}"}], ",", "1", ",", "2", ",", "0.01", 
                ",", 
                RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}],
               "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"no", ",", "1.2", ",", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<index \>\"", ",", " ", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<n\>\"", ",", " ", "\"\<o\>\""}], "]"}]}], 
                    "}"}], "]"}]}], "}"}], ",", "1", ",", "2", ",", "0.01", 
                ",", 
                RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}],
               "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ne", ",", "1.6", ",", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<index \>\"", ",", " ", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<n\>\"", ",", " ", "\"\<e\>\""}], "]"}]}], 
                    "}"}], "]"}]}], "}"}], ",", "1", ",", "2", ",", "0.01", 
                ",", 
                RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}],
               "]"}]}], "}"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
         "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\[Theta]ind", ",", "50", ",", 
              "\"\<angle of incidence (\[Degree])\>\""}], "}"}], ",", 
            RowBox[{"-", "89.99"}], ",", "89.99", ",", "1", ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
          "]"}], ",", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\[Theta]pol", ",", "45", ",", 
              "\"\<polarization (0\[Degree] is s\[Hyphen]pol.)\>\""}], "}"}], 
            ",", "0", ",", "90", ",", "1", ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
          "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\[Theta]", ",", "0", ",", 
              "\"\<optical axis elevation (\[Degree])\>\""}], "}"}], ",", 
            RowBox[{"-", "90"}], ",", "90", ",", "1", ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
          "]"}], ",", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "Q", ",", "45", ",", 
              "\"\<optical axis rotation (\[Degree])\>\""}], "}"}], ",", 
            RowBox[{"-", "90"}], ",", "90", ",", "1", ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
          "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "step", ",", "0.5", ",", 
              "\"\<angular step (\[Degree]) for Fresnel\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0.01", ",", "0.1", ",", "0.2", ",", "0.5", ",", "1"}], 
             "}"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
            RowBox[{"ControlType", "\[Rule]", "RadioButton"}]}], "}"}], "]"}],
          ",", "\[IndentingNewLine]", "SpanFromLeft"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Alignment", "\[Rule]", "Left"}]}], "\[IndentingNewLine]", "]"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"ContinuousAction", "\[Rule]", "False"}], ",", 
   RowBox[{"LabelStyle", "\[Rule]", 
    RowBox[{"{", "12", "}"}]}], ",", 
   RowBox[{"AutorunSequencing", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "15"}], "}"}], "}"}]}], ",", 
   RowBox[{"TrackedSymbols", "\[RuleDelayed]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.5622359425946565`*^9, {3.562236036163621*^9, 3.5622361531638265`*^9}, {
   3.56223632590293*^9, 3.5622363596925893`*^9}, {3.56223640028386*^9, 
   3.562236412997883*^9}, {3.5622364527935524`*^9, 3.5622365038368425`*^9}, {
   3.562237269374587*^9, 3.5622373043498487`*^9}, {3.562300714441271*^9, 
   3.5623007728477736`*^9}, {3.562300875863155*^9, 3.5623008922431836`*^9}, 
   3.5623459724865503`*^9, {3.562346029671715*^9, 3.562346036415752*^9}, {
   3.56234608882796*^9, 3.562346093159018*^9}, {3.562346752022251*^9, 
   3.562346759709889*^9}, {3.562380951519516*^9, 3.562380963979533*^9}, {
   3.562388491097924*^9, 3.562388505587944*^9}, {3.562429174880754*^9, 
   3.5624291758187647`*^9}, {3.5624292296771917`*^9, 3.562429230354014*^9}, {
   3.562429271663068*^9, 3.562429275652232*^9}, {3.562429361260462*^9, 
   3.5624294244275846`*^9}, {3.562429519727942*^9, 3.562429520181677*^9}, {
   3.562429552307132*^9, 3.562429561033257*^9}, 3.562937438620659*^9, {
   3.5629531075867453`*^9, 3.562953114232099*^9}, {3.562954813565889*^9, 
   3.562954814593369*^9}, {3.562954966614092*^9, 3.562954966778088*^9}, {
   3.562955218674705*^9, 3.56295521883862*^9}, {3.56295528949267*^9, 
   3.5629552944284277`*^9}, 3.5636432341137657`*^9, {3.563643284926592*^9, 
   3.563643298555065*^9}},
 CellID->429195152]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ne$$ = 1.6, $CellContext`ni$$ = 
    1., $CellContext`no$$ = 1.2, $CellContext`plot$$ = 
    "2D vectors", $CellContext`Q$$ = 45, $CellContext`step$$ = 
    0.5, $CellContext`\[Theta]$$ = 0, $CellContext`\[Theta]ind$$ = 
    50, $CellContext`\[Theta]pol$$ = 45, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`plot$$], "2D vectors"}, {
      "data", "2D k\[Hyphen]surfaces", "2D vectors", "Fresnel (r, t)", 
       "phases", "Fresnel (R, T)"}}, {{
       Hold[$CellContext`ni$$], 1., 
       Row[{"index ", 
         Subscript["n", "i"]}]}, 1, 2, 0.01}, {{
       Hold[$CellContext`no$$], 1.2, 
       Row[{"index ", 
         Subscript["n", "o"]}]}, 1, 2, 0.01}, {{
       Hold[$CellContext`ne$$], 1.6, 
       Row[{"index ", 
         Subscript["n", "e"]}]}, 1, 2, 0.01}, {{
       Hold[$CellContext`\[Theta]ind$$], 50, 
       "angle of incidence (\[Degree])"}, -89.99, 89.99, 1}, {{
       Hold[$CellContext`\[Theta]pol$$], 45, 
       "polarization (0\[Degree] is s\[Hyphen]pol.)"}, 0, 90, 1}, {{
       Hold[$CellContext`\[Theta]$$], 0, 
       "optical axis elevation (\[Degree])"}, -90, 90, 1}, {{
       Hold[$CellContext`Q$$], 45, "optical axis rotation (\[Degree])"}, -90, 
      90, 1}, {{
       Hold[$CellContext`step$$], 0.5, 
       "angular step (\[Degree]) for Fresnel"}, {0.01, 0.1, 0.2, 0.5, 1}}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], SpanFromLeft}, {
          Grid[{{
             Manipulate`Place[2], 
             Manipulate`Place[3], 
             Manipulate`Place[4]}}], SpanFromLeft}, {
          Manipulate`Place[5], 
          Manipulate`Place[6]}, {
          Manipulate`Place[7], 
          Manipulate`Place[8]}, {
          Manipulate`Place[9], SpanFromLeft}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    600., {185., 190.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`plot$11528$$ = 
    0, $CellContext`ni$11529$$ = 0, $CellContext`no$11530$$ = 
    0, $CellContext`ne$11531$$ = 0, $CellContext`\[Theta]ind$11532$$ = 
    0, $CellContext`\[Theta]pol$11533$$ = 0, $CellContext`\[Theta]$11534$$ = 
    0, $CellContext`Q$11535$$ = 0, $CellContext`step$11536$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`ne$$ = 1.6, $CellContext`ni$$ = 
        1., $CellContext`no$$ = 1.2, $CellContext`plot$$ = 
        "2D vectors", $CellContext`Q$$ = 45, $CellContext`step$$ = 
        0.5, $CellContext`\[Theta]$$ = 0, $CellContext`\[Theta]ind$$ = 
        50, $CellContext`\[Theta]pol$$ = 45}, "ControllerVariables" :> {
        Hold[$CellContext`plot$$, $CellContext`plot$11528$$, 0], 
        Hold[$CellContext`ni$$, $CellContext`ni$11529$$, 0], 
        Hold[$CellContext`no$$, $CellContext`no$11530$$, 0], 
        Hold[$CellContext`ne$$, $CellContext`ne$11531$$, 0], 
        Hold[$CellContext`\[Theta]ind$$, $CellContext`\[Theta]ind$11532$$, 0], 
        Hold[$CellContext`\[Theta]pol$$, $CellContext`\[Theta]pol$11533$$, 0], 
        Hold[$CellContext`\[Theta]$$, $CellContext`\[Theta]$11534$$, 0], 
        Hold[$CellContext`Q$$, $CellContext`Q$11535$$, 0], 
        Hold[$CellContext`step$$, $CellContext`step$11536$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`power := ($CellContext`\[Theta]init = 
          0.; $CellContext`\[CapitalDelta]\[Theta] = $CellContext`step$$; \
$CellContext`max = 90./$CellContext`step$$; 
         For[$CellContext`i = 0, $CellContext`i <= $CellContext`max, 
           Increment[$CellContext`i], $CellContext`\[Theta]i[$CellContext`i] = 
            If[$CellContext`i < $CellContext`max, $CellContext`\[Theta]init + \
$CellContext`i $CellContext`\[CapitalDelta]\[Theta], \
$CellContext`\[Theta]init + $CellContext`i $CellContext`\[CapitalDelta]\
\[Theta] - 
              0.01]; $CellContext`\[Theta]inr = \
$CellContext`\[Theta]i[$CellContext`i] (Pi/180.); $CellContext`\[Theta]or = 
            ArcSin[$CellContext`ni$$ (
               Sin[$CellContext`\[Theta]i[$CellContext`i] (Pi/
                  180.)]/$CellContext`no$$)]; \
$CellContext`ango[$CellContext`i] = $CellContext`\[Theta]or; $CellContext`m1 = 
            FindRoot[$CellContext`ni$$ 
               Sin[$CellContext`\[Theta]i[$CellContext`i] (Pi/
                  180.)] == (($CellContext`no$$ $CellContext`ne$$)/
                Sqrt[$CellContext`no$$^2 + ($CellContext`ne$$^2 - \
$CellContext`no$$^2) (((-Sin[$CellContext`d\[Theta]]) 
                    Cos[Pi ($CellContext`\[Theta]$$/180.)]) 
                    Sin[Pi ($CellContext`Q$$/180.)] + (
                    Cos[$CellContext`d\[Theta]] 
                    Cos[$CellContext`Q$$ (Pi/180.)]) 
                    Cos[Pi ($CellContext`\[Theta]$$/180.)])^2]) 
               Sin[$CellContext`d\[Theta]], {$CellContext`d\[Theta], 
               Re[$CellContext`\[Theta]or]/2 - (Re[$CellContext`\[Theta]or]/5)
                 I}]; $CellContext`\[Theta]er = 
            ReplaceAll[$CellContext`d\[Theta], $CellContext`m1]; \
$CellContext`n\[CurlyPhi] = ($CellContext`no$$ $CellContext`ne$$)/
             Sqrt[$CellContext`no$$^2 + ($CellContext`ne$$^2 - \
$CellContext`no$$^2) (((-Sin[$CellContext`\[Theta]er]) 
                   Cos[Pi ($CellContext`\[Theta]$$/180.)]) 
                  Sin[Pi ($CellContext`Q$$/180.)] + (
                   Cos[$CellContext`\[Theta]er] 
                   Cos[$CellContext`Q$$ (Pi/180.)]) 
                  Cos[Pi ($CellContext`\[Theta]$$/
                    180.)])^2]; {$CellContext`xe, $CellContext`ye, \
$CellContext`ze} = {
             0, $CellContext`n\[CurlyPhi] 
              Sin[$CellContext`\[Theta]er], $CellContext`n\[CurlyPhi] 
              Cos[$CellContext`\[Theta]er]}; $CellContext`ke = {0, 
              Sin[$CellContext`\[Theta]er], 
              
              Cos[$CellContext`\[Theta]er]}; $CellContext`ko = \
($CellContext`So = {0, 
               Sin[$CellContext`\[Theta]or], 
               Cos[$CellContext`\[Theta]or]}); $CellContext`oa = {
              Sin[
              Pi ($CellContext`\[Theta]$$/180.)], (-
               Cos[Pi ($CellContext`\[Theta]$$/180.)]) 
              Sin[Pi ($CellContext`Q$$/180.)], 
              Cos[Pi ($CellContext`\[Theta]$$/180.)] 
              Cos[Pi ($CellContext`Q$$/180.)]}; $CellContext`xse = ((((
                 1/($CellContext`ne$$^2 $CellContext`no$$^2)) \
($CellContext`ne$$ - $CellContext`no$$)) ($CellContext`ne$$ + \
$CellContext`no$$)) ($CellContext`ze 
                Cos[Pi ($CellContext`Q$$/180.)] - $CellContext`ye 
               Sin[Pi ($CellContext`Q$$/180.)])) 
             Sin[Pi ($CellContext`\[Theta]$$/90.)]; $CellContext`yse = (
              1/((4 $CellContext`ne$$^2) $CellContext`no$$^2)) ((
                2 $CellContext`ne$$^2) $CellContext`ye + (
                6 $CellContext`no$$^2) $CellContext`ye + (($CellContext`ne$$ - \
$CellContext`no$$) ($CellContext`ne$$ + $CellContext`no$$)) ((
                  2 $CellContext`ye) 
                 Cos[Pi ($CellContext`\[Theta]$$/
                    90.)] - (($CellContext`ye - $CellContext`ze) 
                 Cos[Pi ($CellContext`Q$$/90.)]) (1 + 
                 Cos[Pi ($CellContext`\[Theta]$$/
                    90.)]) - (($CellContext`ye + $CellContext`ze) 
                 Cos[Pi ($CellContext`Q$$/90.)]) (1 + 
                 Cos[Pi ($CellContext`\[Theta]$$/90.)]) - ((4 $CellContext`ze)
                   Cos[Pi ($CellContext`\[Theta]$$/180.)]^2) 
                Sin[Pi ($CellContext`Q$$/90.)])); $CellContext`zse = (
              1/((4 $CellContext`ne$$^2) $CellContext`no$$^2)) ((
                2 $CellContext`ne$$^2) $CellContext`ze + (
                6 $CellContext`no$$^2) $CellContext`ze + (($CellContext`ne$$ - \
$CellContext`no$$) ($CellContext`ne$$ + $CellContext`no$$)) ((
                  2 $CellContext`ze) 
                 Cos[Pi ($CellContext`\[Theta]$$/
                    90.)] - (($CellContext`ye - $CellContext`ze) 
                 Cos[Pi ($CellContext`Q$$/90.)]) (1 + 
                 Cos[Pi ($CellContext`\[Theta]$$/
                    90.)]) + (($CellContext`ye + $CellContext`ze) 
                  Cos[Pi ($CellContext`Q$$/90.)]) (1 + 
                  Cos[Pi ($CellContext`\[Theta]$$/90.)]) - ((
                  4 $CellContext`ye) Cos[Pi ($CellContext`\[Theta]$$/180.)]^2)
                  Sin[Pi ($CellContext`Q$$/
                   90.)])); $CellContext`Se = ({$CellContext`xSe, \
$CellContext`ySe, $CellContext`zSe} = 
             Normalize[{$CellContext`xse, $CellContext`yse, \
$CellContext`zse}]); $CellContext`\[Theta]Se = 
            VectorAngle[$CellContext`Se, {0., 0., 
              1.}]; $CellContext`angS[$CellContext`i] = \
$CellContext`\[Theta]Se; $CellContext`ki = {0, 
              Sin[$CellContext`\[Theta]inr], 
              Cos[$CellContext`\[Theta]inr]}; $CellContext`kip = {0, 
              Cos[$CellContext`\[Theta]inr], -
              Sin[$CellContext`\[Theta]inr]}; $CellContext`kr = {0, 
              Sin[$CellContext`\[Theta]inr], -
              Cos[$CellContext`\[Theta]inr]}; $CellContext`krp = {
             0, -Cos[$CellContext`\[Theta]inr], -
              Sin[$CellContext`\[Theta]inr]}; $CellContext`\[Theta]Er = \
$CellContext`\[Theta]Einc (Pi/180.); $CellContext`Einc = 
            Cos[$CellContext`\[Theta]pol$$ (Pi/180.)] {1., 0., 0.} + 
             Sin[$CellContext`\[Theta]pol$$ (Pi/
                 180.)] $CellContext`kip; $CellContext`\[Theta]s = 
            VectorAngle[$CellContext`ke, $CellContext`Se]; $CellContext`nS = \
$CellContext`n\[CurlyPhi] 
             Cos[$CellContext`\[Theta]s]; $CellContext`Eref = $CellContext`rs \
{1., 0., 0.} + $CellContext`rp $CellContext`krp; If[
             
             Or[$CellContext`\[Theta]$$ == 
              0, $CellContext`no$$ == $CellContext`ne$$], \
$CellContext`dirEord = {1., 0., 0.}, $CellContext`dirEord = Normalize[
               
               Cross[$CellContext`ko, $CellContext`oa]]]; $CellContext`Eord = \
$CellContext`to $CellContext`dirEord; If[
             Or[
              
              And[$CellContext`Q$$ == 
               0, $CellContext`\[Theta]i[$CellContext`i] == 
               0, $CellContext`\[Theta]$$ == 
               0], $CellContext`no$$ == $CellContext`ne$$], \
$CellContext`dirEext = {0, 
               Cos[$CellContext`\[Theta]er], -
               Sin[$CellContext`\[Theta]er]}, $CellContext`dirEext = Normalize[
               Cross[
                
                Cross[$CellContext`ke, $CellContext`oa], $CellContext`Se]]]; \
$CellContext`Eext = $CellContext`te $CellContext`dirEext; $CellContext`Hinc = \
$CellContext`ni$$ 
             
             Cross[$CellContext`ki, $CellContext`Einc]; $CellContext`Href = \
$CellContext`ni$$ 
             Cross[$CellContext`kr, $CellContext`Eref]; $CellContext`Hord = \
$CellContext`no$$ 
             Cross[$CellContext`ko, $CellContext`Eord]; $CellContext`Hext = \
$CellContext`n\[CurlyPhi] 
             Cross[$CellContext`ke, $CellContext`Eext]; $CellContext`fresnel = 
            Flatten[
              
              Solve[{Dot[$CellContext`Einc + $CellContext`Eref, {1., 0., 0.}] == 
                Dot[$CellContext`Eord + $CellContext`Eext, {1., 0., 0.}], 
                Dot[$CellContext`Einc + $CellContext`Eref, {0., 1., 0.}] == 
                Dot[$CellContext`Eord + $CellContext`Eext, {0., 1., 0.}], 
                Dot[$CellContext`Hinc + $CellContext`Href, {1., 0., 0.}] == 
                Dot[$CellContext`Hord + $CellContext`Hext, {1., 0., 0.}], 
                Dot[$CellContext`Hinc + $CellContext`Href, {0., 1., 0.}] == 
                Dot[$CellContext`Hord + $CellContext`Hext, {0., 1., 
                  0.}]}, {$CellContext`rs, $CellContext`rp, $CellContext`to, \
$CellContext`te}]]; Subscript[$CellContext`rs, 
              $CellContext`\[Theta]i[$CellContext`i]] = 
            Part[$CellContext`fresnel, 1, 2]; Subscript[$CellContext`rp, 
              $CellContext`\[Theta]i[$CellContext`i]] = 
            Part[$CellContext`fresnel, 2, 2]; Subscript[$CellContext`to, 
              $CellContext`\[Theta]i[$CellContext`i]] = 
            Part[$CellContext`fresnel, 3, 2]; Subscript[$CellContext`te, 
              $CellContext`\[Theta]i[$CellContext`i]] = 
            Part[$CellContext`fresnel, 4, 2]; Subscript[$CellContext`Rp, 
              $CellContext`\[Theta]i[$CellContext`i]] = 
            Chop[Subscript[$CellContext`rp, 
                $CellContext`\[Theta]i[$CellContext`i]] Conjugate[
                Subscript[$CellContext`rp, 
                 $CellContext`\[Theta]i[$CellContext`i]]]]; 
           Subscript[$CellContext`Rs, 
              $CellContext`\[Theta]i[$CellContext`i]] = 
            Chop[Subscript[$CellContext`rs, 
                $CellContext`\[Theta]i[$CellContext`i]] Conjugate[
                Subscript[$CellContext`rs, 
                 $CellContext`\[Theta]i[$CellContext`i]]]]; 
           Subscript[$CellContext`To, 
              $CellContext`\[Theta]i[$CellContext`i]] = Chop[
              
              Re[(($CellContext`no$$ (
                  Cos[$CellContext`\[Theta]or]/($CellContext`ni$$ 
                  Cos[$CellContext`\[Theta]inr]))) 
                Subscript[$CellContext`to, 
                  $CellContext`\[Theta]i[$CellContext`i]]) Conjugate[
                 Subscript[$CellContext`to, 
                  $CellContext`\[Theta]i[$CellContext`i]]]]]; 
           Subscript[$CellContext`Te, 
              $CellContext`\[Theta]i[$CellContext`i]] = Chop[
              
              Re[(($CellContext`nS (
                  Cos[$CellContext`\[Theta]Se]/($CellContext`ni$$ 
                  Cos[$CellContext`\[Theta]inr]))) 
                Subscript[$CellContext`te, 
                  $CellContext`\[Theta]i[$CellContext`i]]) Conjugate[
                 Subscript[$CellContext`te, 
                  $CellContext`\[Theta]i[$CellContext`i]]]]]; 
           Null]; $CellContext`transo = Table[{
             $CellContext`\[Theta]i[$CellContext`i], 
             Chop[
              $CellContext`ango[$CellContext`i]]}, {$CellContext`i, 
             0, $CellContext`max}]; $CellContext`transe = Table[{
             $CellContext`\[Theta]i[$CellContext`i], 
             Chop[
              $CellContext`angS[$CellContext`i]]}, {$CellContext`i, 
             0, $CellContext`max}]; $CellContext`dataRp = Table[{
             $CellContext`\[Theta]i[$CellContext`i], 
             Subscript[$CellContext`Rp, 
              $CellContext`\[Theta]i[$CellContext`i]]}, {$CellContext`i, 
             0, $CellContext`max}]; $CellContext`brewster = 
          If[$CellContext`\[Theta]pol$$ != 0, 
            Part[
             First[
              Sort[$CellContext`dataRp, Part[#, 2] < Part[#2, 2]& ]], 
             1]]; $CellContext`tiro = 
          If[$CellContext`ni$$ >= $CellContext`no$$, 
            Part[
             Last[
              Cases[$CellContext`transo, {
                Blank[Real], 
                Blank[Real]}]], 1], "No TIR"]; $CellContext`tire = 
          If[$CellContext`ni$$ >= $CellContext`ne$$, 
            Part[
             Last[
              Cases[$CellContext`transe, {
                Blank[Real], 
                Blank[Real]}]], 1], "No TIR"]; 
         If[$CellContext`plot$$ == 
           "Fresnel (R, T)", $CellContext`dataRs = Table[{
               $CellContext`\[Theta]i[$CellContext`i], 
               Subscript[$CellContext`Rs, 
                $CellContext`\[Theta]i[$CellContext`i]]}, {$CellContext`i, 
               0, $CellContext`max}]; $CellContext`dataTo = Table[{
               $CellContext`\[Theta]i[$CellContext`i], 
               Subscript[$CellContext`To, 
                $CellContext`\[Theta]i[$CellContext`i]]}, {$CellContext`i, 
               0, $CellContext`max}]; $CellContext`dataTe = Table[{
               $CellContext`\[Theta]i[$CellContext`i], 
               Subscript[$CellContext`Te, 
                $CellContext`\[Theta]i[$CellContext`i]]}, {$CellContext`i, 
               0, $CellContext`max}]; $CellContext`dataRtotal = Table[{
               $CellContext`\[Theta]i[$CellContext`i], 
               Subscript[$CellContext`Rs, 
                 $CellContext`\[Theta]i[$CellContext`i]] + 
               Subscript[$CellContext`Rp, 
                 $CellContext`\[Theta]i[$CellContext`i]]}, {$CellContext`i, 
               0, $CellContext`max}]; $CellContext`dataTotal = Table[{
               $CellContext`\[Theta]i[$CellContext`i], 
               Subscript[$CellContext`Rs, 
                 $CellContext`\[Theta]i[$CellContext`i]] + 
               Subscript[$CellContext`Rp, 
                 $CellContext`\[Theta]i[$CellContext`i]] + 
               Subscript[$CellContext`To, 
                 $CellContext`\[Theta]i[$CellContext`i]] + 
               Subscript[$CellContext`Te, 
                 $CellContext`\[Theta]i[$CellContext`i]]}, {$CellContext`i, 
               0, $CellContext`max}]; $CellContext`normalincidence = (
              Part[$CellContext`dataRp, 1, 2] + 
              Part[$CellContext`dataRs, 1, 2]) 100; Column[{
              ListLinePlot[{
                Tooltip[$CellContext`dataRp, 
                 Subscript[
                  Style["R", Italic], "p"]], 
                Tooltip[$CellContext`dataRs, 
                 Subscript[
                  Style["R", Italic], "s"]], 
                Tooltip[$CellContext`dataTo, 
                 Subscript[
                  Style["T", Italic], "o"]], 
                Tooltip[$CellContext`dataTe, 
                 Subscript[
                  Style["T", Italic], "e"]], 
                Tooltip[$CellContext`dataTotal, "Total"]}, Frame -> True, 
               PlotRange -> {{$CellContext`\[Theta]init, \
$CellContext`\[Theta]init + $CellContext`max $CellContext`\[CapitalDelta]\
\[Theta]}, {0, 1.01}}, 
               FrameLabel -> {
                "angle of incidence (\[Degree])", "power ratios"}, PlotLabel -> 
               Style[
                 
                 Row[{"polarization ", $CellContext`\[Theta]pol$$, 
                   "\[Degree] (from s\[Hyphen]pol.), ", 
                   Subscript[
                    Style["n", Italic], "i"], " = ", $CellContext`ni$$, ", " 
                   Subscript[
                    Style["n", Italic], "o"], " = ", $CellContext`no$$, ", ", 
                   
                   Subscript[
                    Style["n", Italic], "e"], " = ", $CellContext`ne$$}], 14],
                LabelStyle -> Directive[13], GridLines -> {
                 Range[0, 90, 10], Automatic}, PlotStyle -> Thickness[0.004], 
               ImageSize -> 500, Epilog -> Inset[
                 Panel[
                  Text[
                   Grid[
                    MapIndexed[{
                    Graphics[{
                    ColorData[1, 
                    First[#2]], Thick, 
                    Line[{{0, 0}, {1, 0}}]}, AspectRatio -> 0.1, ImageSize -> 
                    20], #}& , {
                    Subscript[
                    Style["R", Italic], "p"], 
                    Subscript[
                    Style["R", Italic], "s"], 
                    Subscript[
                    Style["T", Italic], "o"], 
                    Subscript[
                    Style["T", Italic], "e"], "Total"}]]]], 
                 Offset[{0, 0}, 
                  Scaled[{0.16, 0.9}]], {Right, Top}]], 
              Text[
               If[$CellContext`\[Theta]pol$$ == 0, 
                Row[{
                  Framed[
                   Style[
                    StringJoin["reflectivity at normal incidence = ", 
                    ToString[
                    Round[$CellContext`normalincidence, 0.01]], " %"], 13], 
                   Background -> LightBlue]}], 
                Row[{
                  Framed[
                   Style[
                    StringJoin["Brewster = ", 
                    ToString[$CellContext`brewster], "\[Degree]"], 13], 
                   Background -> LightBlue], 
                  Framed[
                   Style[
                    StringJoin["reflectivity (0\[Degree]) = ", 
                    ToString[
                    Round[$CellContext`normalincidence, 0.01]], "%"], 13], 
                   Background -> LightBlue], 
                  Framed[
                   Style[
                    Row[{
                    Subscript["TIR", "o"], " = ", $CellContext`tiro, 
                    "\[Degree]"}], 13], Background -> LightBlue], 
                  Framed[
                   Style[
                    Row[{
                    Subscript["TIR", "e"], " = ", $CellContext`tire, 
                    "\[Degree]"}], 13], Background -> LightBlue]}]]]}, 
             Alignment -> Center], $CellContext`datarp = Table[{
               $CellContext`\[Theta]i[$CellContext`i], 
               Abs[
                Subscript[$CellContext`rp, 
                 $CellContext`\[Theta]i[$CellContext`i]]]}, {$CellContext`i, 
               0, $CellContext`max}]; $CellContext`datars = Table[{
               $CellContext`\[Theta]i[$CellContext`i], 
               Abs[
                Subscript[$CellContext`rs, 
                 $CellContext`\[Theta]i[$CellContext`i]]]}, {$CellContext`i, 
               0, $CellContext`max}]; $CellContext`datato = Table[{
               $CellContext`\[Theta]i[$CellContext`i], 
               Abs[
                Subscript[$CellContext`to, 
                 $CellContext`\[Theta]i[$CellContext`i]]]}, {$CellContext`i, 
               0, $CellContext`max}]; $CellContext`datate = Table[{
               $CellContext`\[Theta]i[$CellContext`i], 
               Abs[
                Subscript[$CellContext`te, 
                 $CellContext`\[Theta]i[$CellContext`i]]]}, {$CellContext`i, 
               0, $CellContext`max}]; $CellContext`phaserp = Table[{
               $CellContext`\[Theta]i[$CellContext`i], (1/Pi) Arg[
                 Chop[
                  Subscript[$CellContext`rp, 
                   $CellContext`\[Theta]i[$CellContext`i]]]]}, \
{$CellContext`i, 0, $CellContext`max}]; $CellContext`phasers = Table[{
               $CellContext`\[Theta]i[$CellContext`i], (1/Pi) Arg[
                 Chop[
                  Subscript[$CellContext`rs, 
                   $CellContext`\[Theta]i[$CellContext`i]]]]}, \
{$CellContext`i, 0, $CellContext`max}]; 
           If[$CellContext`plot$$ == "Fresnel (r, t)", 
             ListLinePlot[{
               Tooltip[$CellContext`datarp, 
                Subscript[
                 Style["r", Italic], "p"]], 
               Tooltip[$CellContext`datars, 
                Subscript[
                 Style["r", Italic], "s"]], 
               Tooltip[$CellContext`datato, 
                Subscript[
                 Style["t", Italic], "o"]], 
               Tooltip[$CellContext`datate, 
                Subscript[
                 Style["t", Italic], "e"]]}, Frame -> True, 
              PlotRange -> {{$CellContext`\[Theta]init, \
$CellContext`\[Theta]init + $CellContext`max $CellContext`\[CapitalDelta]\
\[Theta]}, {0, 1}}, 
              FrameLabel -> {
               "angle of incidence (\[Degree])", "Fresnel amplitudes (Abs)"}, 
              PlotLabel -> Style[
                
                Row[{"polarization ", $CellContext`\[Theta]pol$$, 
                  "\[Degree] (from s\[Hyphen]pol.), ", 
                  Subscript[
                   Style["n", Italic], "i"], " = ", $CellContext`ni$$, ", " 
                  Subscript[
                    Style["n", Italic], "o"], " = ", $CellContext`no$$, ", ", 
                  
                  Subscript[
                   Style["n", Italic], "e"], " = ", $CellContext`ne$$}], 14], 
              LabelStyle -> Directive[13], GridLines -> {
                Range[0, 90, 10], Automatic}, PlotStyle -> Thickness[0.004], 
              ImageSize -> 500, Epilog -> Inset[
                Panel[
                 Text[
                  Grid[
                   MapIndexed[{
                    Graphics[{
                    ColorData[1, 
                    First[#2]], Thick, 
                    Line[{{0, 0}, {1, 0}}]}, AspectRatio -> 0.1, ImageSize -> 
                    20], #}& , {
                    Subscript[
                    Style["r", Italic], "p"], 
                    Subscript[
                    Style["r", Italic], "s"], 
                    Subscript[
                    Style["t", Italic], "o"], 
                    Subscript[
                    Style["t", Italic], "e"]}]]]], 
                Offset[{0, 0}, 
                 Scaled[{0.16, 0.9}]], {Right, Top}]], 
             Column[{
               ListLinePlot[{
                 Tooltip[$CellContext`phaserp, 
                  Subscript[
                   Style["r", Italic], "p"]], 
                 Tooltip[$CellContext`phasers, 
                  Subscript[
                   Style["r", Italic], "s"]]}, Frame -> True, 
                PlotRange -> {{0, 90}, Automatic}, 
                FrameLabel -> {
                 "angle of incidence (\[Degree])", "phase (\[Pi] radians)"}, 
                PlotLabel -> Style[
                  
                  Row[{"polarization ", $CellContext`\[Theta]pol$$, 
                    "\[Degree] (from s\[Hyphen]pol.), ", 
                    Subscript[
                    Style["n", Italic], "i"], " = ", $CellContext`ni$$, ", " 
                    Subscript[
                    Style["n", Italic], "o"], " = ", $CellContext`no$$, ", ", 
                    
                    Subscript[
                    Style["n", Italic], "e"], " = ", $CellContext`ne$$}], 14],
                 LabelStyle -> Directive[13], GridLines -> {
                  Range[0, 90, 10], Automatic}, PlotStyle -> Thickness[0.004],
                 ImageSize -> 500, Epilog -> Inset[
                  Panel[
                   Text[
                    Grid[
                    MapIndexed[{
                    Graphics[{
                    ColorData[1, 
                    First[#2]], Thick, 
                    Line[{{0, 0}, {1, 0}}]}, AspectRatio -> 0.1, ImageSize -> 
                    20], #}& , {
                    Subscript[
                    Style["r", Italic], "p"], 
                    Subscript[
                    Style["r", Italic], "s"]}]]]], 
                  Offset[{0, 0}, 
                   Scaled[{0.16, 0.9}]], {Right, Top}]], 
               Text[
                Row[{
                  Framed[
                   Style[
                    StringJoin["Brewster = ", 
                    ToString[$CellContext`brewster], "\[Degree]"], 13], 
                   Background -> LightBlue], 
                  Framed[
                   Style[
                    Row[{
                    Subscript["TIR", "o"], " = ", $CellContext`tiro, 
                    "\[Degree]"}], 13], Background -> LightBlue], 
                  Framed[
                   Style[
                    Row[{
                    Subscript["TIR", "e"], " = ", $CellContext`tire, 
                    "\[Degree]"}], 13], Background -> LightBlue]}]]}, 
              Alignment -> 
              Center]]]); $CellContext`\[Theta]inr = \
$CellContext`\[Theta]ind$$ (Pi/180.); $CellContext`\[Theta]or = 
        ArcSin[$CellContext`ni$$ (
           Sin[$CellContext`\[Theta]ind$$ (Pi/
              180.)]/$CellContext`no$$)]; $CellContext`\[Theta]od = (180./
          Pi) $CellContext`\[Theta]or; $CellContext`\[Theta]odx = 
        90. - $CellContext`\[Theta]od; $CellContext`\[Theta]odre = If[
          Element[$CellContext`\[Theta]od, Reals], $CellContext`\[Theta]od, 
          90.]; $CellContext`m1 = 
        FindRoot[$CellContext`ni$$ 
           Sin[$CellContext`\[Theta]ind$$ (Pi/
              180.)] == (($CellContext`no$$ $CellContext`ne$$)/
            Sqrt[$CellContext`no$$^2 + ($CellContext`ne$$^2 - \
$CellContext`no$$^2) (((-Sin[$CellContext`d\[Theta]]) 
                  Cos[Pi ($CellContext`\[Theta]$$/180.)]) 
                 Sin[Pi ($CellContext`Q$$/180.)] + (
                  Cos[$CellContext`d\[Theta]] Cos[$CellContext`Q$$ (Pi/180.)])
                   Cos[Pi ($CellContext`\[Theta]$$/180.)])^2]) 
           Sin[$CellContext`d\[Theta]], {$CellContext`d\[Theta], 
           Re[$CellContext`\[Theta]or]/2 - (Re[$CellContext`\[Theta]or]/5) 
           I}]; $CellContext`\[Theta]er = Chop[
          
          ReplaceAll[$CellContext`d\[Theta], $CellContext`m1]]; $CellContext`\
\[Theta]ed = $CellContext`\[Theta]er (180./Pi); $CellContext`\[Theta]edx = 
        90. - $CellContext`\[Theta]ed; $CellContext`\[Theta]edre = If[
          Element[$CellContext`\[Theta]ed, Reals], $CellContext`\[Theta]ed, 
          90.]; $CellContext`\[CurlyPhi]er = $CellContext`Q$$ (Pi/
           180.) + $CellContext`\[Theta]er; $CellContext`\[CurlyPhi]ed = \
$CellContext`\[Theta]ed + $CellContext`Q$$; $CellContext`Qx = 
        90. + $CellContext`Q$$; $CellContext`n\[CurlyPhi] = \
($CellContext`no$$ $CellContext`ne$$)/
         Sqrt[$CellContext`no$$^2 + ($CellContext`ne$$^2 - \
$CellContext`no$$^2) (((-Sin[$CellContext`\[Theta]er]) 
               Cos[Pi ($CellContext`\[Theta]$$/180.)]) 
              Sin[Pi ($CellContext`Q$$/180.)] + (Cos[$CellContext`\[Theta]er] 
               Cos[$CellContext`Q$$ (Pi/180.)]) 
              Cos[Pi ($CellContext`\[Theta]$$/
                 180.)])^2]; {$CellContext`OAx, $CellContext`OAy, \
$CellContext`OAz} = ($CellContext`oa = {
           Sin[
           Pi ($CellContext`\[Theta]$$/180.)], (-
            Cos[Pi ($CellContext`\[Theta]$$/180.)]) 
           Sin[Pi ($CellContext`Q$$/180.)], 
           Cos[Pi ($CellContext`\[Theta]$$/180.)] 
           Cos[
            Pi ($CellContext`Q$$/
              180.)]}); {$CellContext`kex, $CellContext`key, \
$CellContext`kez} = ($CellContext`ke = {0, 
           Sin[$CellContext`\[Theta]er], 
           
           Cos[$CellContext`\[Theta]er]}); {$CellContext`kox, \
$CellContext`koy, $CellContext`koz} = ($CellContext`ko = ($CellContext`So = {
           0, 
            Sin[$CellContext`\[Theta]or], 
            
            Cos[$CellContext`\[Theta]or]})); {$CellContext`kix, \
$CellContext`kiy, $CellContext`kiz} = ($CellContext`ki = {0, 
           Sin[$CellContext`\[Theta]inr], 
           
           Cos[$CellContext`\[Theta]inr]}); {$CellContext`krx, \
$CellContext`kry, $CellContext`krz} = ($CellContext`kr = {0, 
           Sin[$CellContext`\[Theta]inr], -
           Cos[$CellContext`\[Theta]inr]}); {$CellContext`xe, \
$CellContext`ye, $CellContext`ze} = {
         0, $CellContext`n\[CurlyPhi] 
          Sin[$CellContext`\[Theta]er], $CellContext`n\[CurlyPhi] 
          Cos[$CellContext`\[Theta]er]}; $CellContext`xse = ((((
             1/($CellContext`ne$$^2 $CellContext`no$$^2)) ($CellContext`ne$$ - \
$CellContext`no$$)) ($CellContext`ne$$ + $CellContext`no$$)) ($CellContext`ze 
            Cos[Pi ($CellContext`Q$$/180.)] - $CellContext`ye 
           Sin[Pi ($CellContext`Q$$/180.)])) 
         Sin[Pi ($CellContext`\[Theta]$$/90.)]; $CellContext`yse = (
          1/((4 $CellContext`ne$$^2) $CellContext`no$$^2)) ((
            2 $CellContext`ne$$^2) $CellContext`ye + (
            6 $CellContext`no$$^2) $CellContext`ye + (($CellContext`ne$$ - \
$CellContext`no$$) ($CellContext`ne$$ + $CellContext`no$$)) ((
              2 $CellContext`ye) 
             Cos[Pi ($CellContext`\[Theta]$$/
                90.)] - (($CellContext`ye - $CellContext`ze) 
             Cos[Pi ($CellContext`Q$$/90.)]) (1 + 
             Cos[Pi ($CellContext`\[Theta]$$/
                90.)]) - (($CellContext`ye + $CellContext`ze) 
             Cos[Pi ($CellContext`Q$$/90.)]) (1 + 
             Cos[Pi ($CellContext`\[Theta]$$/90.)]) - ((4 $CellContext`ze) 
             Cos[Pi ($CellContext`\[Theta]$$/180.)]^2) 
            Sin[Pi ($CellContext`Q$$/90.)])); $CellContext`zse = (
          1/((4 $CellContext`ne$$^2) $CellContext`no$$^2)) ((
            2 $CellContext`ne$$^2) $CellContext`ze + (
            6 $CellContext`no$$^2) $CellContext`ze + (($CellContext`ne$$ - \
$CellContext`no$$) ($CellContext`ne$$ + $CellContext`no$$)) ((
              2 $CellContext`ze) 
             Cos[Pi ($CellContext`\[Theta]$$/
                90.)] - (($CellContext`ye - $CellContext`ze) 
             Cos[Pi ($CellContext`Q$$/90.)]) (1 + 
             Cos[Pi ($CellContext`\[Theta]$$/
                90.)]) + (($CellContext`ye + $CellContext`ze) 
              Cos[Pi ($CellContext`Q$$/90.)]) (1 + 
              Cos[Pi ($CellContext`\[Theta]$$/90.)]) - ((4 $CellContext`ye) 
             Cos[Pi ($CellContext`\[Theta]$$/180.)]^2) 
            Sin[Pi ($CellContext`Q$$/
               90.)])); $CellContext`Se = ({$CellContext`xSe, \
$CellContext`ySe, $CellContext`zSe} = 
         Normalize[{$CellContext`xse, $CellContext`yse, $CellContext`zse}]); \
$CellContext`\[Theta]Se = 
        VectorAngle[$CellContext`Se, {0., 0., 1.}]; $CellContext`plane = 
        Det[{{$CellContext`x, $CellContext`y, $CellContext`z, 1}, {
            Re[$CellContext`kex], 
            Re[$CellContext`key], 
            Re[$CellContext`kez], 
            1}, {$CellContext`OAx, $CellContext`OAy, $CellContext`OAz, 1}, {
            Re[$CellContext`xSe], 
            Re[$CellContext`ySe], 
            Re[$CellContext`zSe], 1}}]; $CellContext`\[Theta]s = 
        VectorAngle[$CellContext`ke, $CellContext`Se]; $CellContext`nS = \
$CellContext`n\[CurlyPhi] Cos[$CellContext`\[Theta]s]; $CellContext`slope2 = 
        If[$CellContext`yse == 0, Infinity, 
          Re[$CellContext`zse/$CellContext`yse]]; $CellContext`\[Theta]Phor = 
        If[$CellContext`slope2 > 0, (180./Pi) 
          ArcTan[$CellContext`slope2], (180./Pi) (Pi + 
           ArcTan[$CellContext`slope2])]; $CellContext`\[Theta]Pre = If[
          
          Element[$CellContext`\[Theta]Phor, 
           Reals], $CellContext`\[Theta]Phor, 90.]; $CellContext`kip = {0, 
          Cos[$CellContext`\[Theta]inr], -
          Sin[$CellContext`\[Theta]inr]}; $CellContext`krp = {
         0, -Cos[$CellContext`\[Theta]inr], -
          Sin[$CellContext`\[Theta]inr]}; $CellContext`Einc = 
        Cos[$CellContext`\[Theta]pol$$ (Pi/180.)] {1., 0., 0.} + 
         Sin[$CellContext`\[Theta]pol$$ (Pi/
             180.)] $CellContext`kip; $CellContext`Eref = $CellContext`rs {1.,
            0., 0.} + $CellContext`rp $CellContext`krp; If[
         Or[$CellContext`\[Theta]$$ == 
          0, $CellContext`no$$ == $CellContext`ne$$], $CellContext`dirEord = {
          1., 0., 0.}, $CellContext`dirEord = Normalize[
           
           Cross[$CellContext`ko, $CellContext`oa]]]; $CellContext`Eord = \
$CellContext`to $CellContext`dirEord; If[
         Or[
          
          And[$CellContext`Q$$ == 0, $CellContext`\[Theta]ind$$ == 
           0, $CellContext`\[Theta]$$ == 
           0], $CellContext`no$$ == $CellContext`ne$$], $CellContext`dirEext = \
{0, 
           Cos[$CellContext`\[Theta]er], -
           Sin[$CellContext`\[Theta]er]}, $CellContext`dirEext = Normalize[
           Cross[
            
            Cross[$CellContext`ke, $CellContext`oa], $CellContext`Se]]]; \
$CellContext`Eext = $CellContext`te $CellContext`dirEext; $CellContext`Hinc = \
$CellContext`ni$$ 
         Cross[$CellContext`ki, $CellContext`Einc]; $CellContext`Href = \
$CellContext`ni$$ 
         Cross[$CellContext`kr, $CellContext`Eref]; $CellContext`Hord = \
$CellContext`no$$ 
         Cross[$CellContext`ko, $CellContext`Eord]; $CellContext`Hext = \
$CellContext`n\[CurlyPhi] 
         Cross[$CellContext`ke, $CellContext`Eext]; $CellContext`fresnel = 
        Flatten[
          
          Solve[{Dot[$CellContext`Einc + $CellContext`Eref, {1., 0., 0.}] == 
            Dot[$CellContext`Eord + $CellContext`Eext, {1., 0., 0.}], 
            Dot[$CellContext`Einc + $CellContext`Eref, {0., 1., 0.}] == 
            Dot[$CellContext`Eord + $CellContext`Eext, {0., 1., 0.}], 
            Dot[$CellContext`Hinc + $CellContext`Href, {1., 0., 0.}] == 
            Dot[$CellContext`Hord + $CellContext`Hext, {1., 0., 0.}], 
            Dot[$CellContext`Hinc + $CellContext`Href, {0., 1., 0.}] == 
            Dot[$CellContext`Hord + $CellContext`Hext, {0., 1., 
              0.}]}, {$CellContext`rs, $CellContext`rp, $CellContext`to, \
$CellContext`te}]]; $CellContext`temprs = 
        Part[$CellContext`fresnel, 1, 2]; $CellContext`temprp = 
        Part[$CellContext`fresnel, 2, 2]; $CellContext`tempto = 
        Part[$CellContext`fresnel, 3, 2]; $CellContext`tempte = 
        Part[$CellContext`fresnel, 4, 2]; $CellContext`tempRp = 
        Chop[$CellContext`temprp 
          Conjugate[$CellContext`temprp]]; $CellContext`tempRs = 
        Chop[$CellContext`temprs 
          Conjugate[$CellContext`temprs]]; $CellContext`tempTo = Chop[
          
          Re[(($CellContext`no$$ (
              Cos[$CellContext`\[Theta]or]/($CellContext`ni$$ 
              Cos[$CellContext`\[Theta]inr]))) $CellContext`tempto) 
           Conjugate[$CellContext`tempto]]]; $CellContext`tempTe = Chop[
          
          Re[(($CellContext`nS (
              Cos[$CellContext`\[Theta]Se]/($CellContext`ni$$ 
              Cos[$CellContext`\[Theta]inr]))) $CellContext`tempte) 
           Conjugate[$CellContext`tempte]]]; $CellContext`info := Text[
          Grid[{{
             Grid[{{
                Row[{"refracted ", 
                  Subscript[
                   Style["k", Italic], "o"]}], $CellContext`\[Theta]od 
                "\[Degree]"}, {
                Row[{"refracted ", 
                  Subscript[
                   Style["k", Italic], "e"]}], $CellContext`\[Theta]ed 
                "\[Degree]"}, {
                Row[{"index ", 
                  Style["n", Italic], "(", 
                  Subscript[
                   Style["k", Italic], "e"], ")"}], 
                Chop[$CellContext`n\[CurlyPhi]]}, {"OA unit vector\n", 
                Chop[$CellContext`oa]}, {
                Row[{
                  Subscript[
                   Style["k", Italic], "inc"], " unit vector "}], 
                Chop[$CellContext`ki]}, {
                Row[{
                  Subscript[
                   Style["k", Italic], "ref"], " unit vector "}], 
                Chop[$CellContext`kr]}, {
                Row[{
                  Subscript[
                   Style["k", Italic], "o"], " unit vector "}], 
                Chop[$CellContext`ko]}, {
                Row[{
                  Subscript[
                   Style["k", Italic], "e"], " unit vector "}], 
                Chop[$CellContext`ke]}, {
                Row[{
                  Subscript[
                   Style["S", Italic], "e"], " unit vector\n "}], 
                Chop[$CellContext`Se]}, {
                Row[{"plane of ", 
                  Subscript[
                   Style["k", Italic], "e"], ", " Subscript[
                    Style["S", Italic], "e"], " \nand OA vectors "}], 
                Row[{
                  TraditionalForm[
                   Simplify[
                    Chop[$CellContext`plane == 0]]]}]}, {
                Row[{
                  Subscript[
                   Style["E", Bold], "inc"]}], 
                Chop[$CellContext`Einc]}}, Alignment -> Left, Frame -> All, 
              Spacings -> 0.5, ItemSize -> {{9, 15}, 1.5}, ItemStyle -> 
              Directive[FontSize -> 13]], 
             Grid[{{
                Row[{
                  Subscript[
                   Style["k", Italic], "e"], ", " Subscript[
                    Style["S", Italic], "e"], " angle"}], 
                Chop[$CellContext`\[Theta]s (180./Pi)] "\[Degree]"}, {
                Row[{"index ", 
                  Style["n", Italic], "(", 
                  Subscript[
                   Style["S", Italic], "e"], ")"}], 
                Chop[$CellContext`nS]}, {
                Row[{
                  Subscript[
                   Style["r", Italic], "s"], ", ", 
                  Subscript[
                   Style["r", Italic], "p"]}], 
                Chop[{$CellContext`temprs, $CellContext`temprp}]}, {
                Row[{
                  Subscript[
                   Style["t", Italic], "o"], ", ", 
                  Subscript[
                   Style["t", Italic], "e"]}], 
                Chop[{$CellContext`tempto, $CellContext`tempte}]}, {
                Row[{
                  Subscript[
                   Style["R", Italic], "s"], ", ", 
                  Subscript[
                   Style["R", Italic], "p"]}], 
                Chop[{$CellContext`tempRs, $CellContext`tempRp}]}, {
                Row[{
                  Subscript[
                   Style["T", Italic], "o"], ", ", 
                  Subscript[
                   Style["T", Italic], "e"], ", ", "Total"}], 
                
                Chop[{$CellContext`tempTo, $CellContext`tempTe, \
$CellContext`tempRs + $CellContext`tempRp + $CellContext`tempTo + \
$CellContext`tempTe}]}, {
                Row[{
                  Subscript[
                   Style["E", Bold], "ref"]}], 
                Round[
                 Chop[
                  ReplaceAll[$CellContext`Eref, $CellContext`fresnel]], 
                 1.*^-6]}, {
                Row[{
                  Subscript[
                   Style["E", Bold], "o"]}], 
                Round[
                 Chop[
                  ReplaceAll[$CellContext`Eord, $CellContext`fresnel]], 
                 1.*^-6]}, {
                Row[{
                  Subscript[
                   Style["E", Bold], "e"]}], 
                Round[
                 Chop[
                  ReplaceAll[$CellContext`Eext, $CellContext`fresnel]], 
                 1.*^-6]}, {
                Row[{
                  Subscript[
                   Style["H", Bold], "inc"]}], 
                Round[
                 Chop[
                  ReplaceAll[$CellContext`Hinc, $CellContext`fresnel]], 
                 1.*^-6]}, {
                Row[{
                  Subscript[
                   Style["H", Bold], "ref"]}], 
                Round[
                 Chop[
                  ReplaceAll[$CellContext`Href, $CellContext`fresnel]], 
                 1.*^-6]}, {
                Row[{
                  Subscript[
                   Style["H", Bold], "o"]}], 
                Round[
                 Chop[
                  ReplaceAll[$CellContext`Hord, $CellContext`fresnel]], 
                 1.*^-6]}, {
                Row[{
                  Subscript[
                   Style["H", Bold], "e"]}], 
                Round[
                 Chop[
                  ReplaceAll[$CellContext`Hext, $CellContext`fresnel]], 
                 1.*^-6]}}, Alignment -> Left, Spacings -> 0.5, Frame -> All, 
              ItemSize -> {{7, 20}, 1.5}, ItemStyle -> 
              Directive[FontSize -> 12]]}}]]; $CellContext`surfaces := 
        ContourPlot[{(
             1/((4 $CellContext`ne$$^2) $CellContext`no$$^2)) \
($CellContext`ne$$^2 ($CellContext`y^2 + $CellContext`z^2) + (
               3 $CellContext`no$$^2) ($CellContext`y^2 + $CellContext`z^2) + \
(($CellContext`ne$$ - $CellContext`no$$) ($CellContext`ne$$ + \
$CellContext`no$$)) (($CellContext`y^2 + $CellContext`z^2) 
                Cos[Pi ($CellContext`\[Theta]$$/
                   90.)] - ((($CellContext`y - $CellContext`z) \
($CellContext`y + $CellContext`z)) Cos[Pi ($CellContext`Q$$/90.)]) (1 + 
                Cos[Pi ($CellContext`\[Theta]$$/90.)]) - (((
                  4 $CellContext`y) $CellContext`z) 
                Cos[Pi ($CellContext`\[Theta]$$/180.)]^2) 
               Sin[Pi ($CellContext`Q$$/90.)])) == 
           1, $CellContext`y^2 + $CellContext`z^2 == $CellContext`no$$^2, \
$CellContext`z == 
           Tan[($CellContext`Q$$ + 90) (Pi/
               180.)] $CellContext`y, $CellContext`y == 0, $CellContext`z == 
           0}, {$CellContext`y, -2.5, 2.5}, {$CellContext`z, -0.02, 2.5}, 
          BaseStyle -> {12}, PerformanceGoal -> {"Quality"}, PlotLabel -> 
          Style[
            Row[{"2D ", 
              Style["k", Italic], 
              "\[Hyphen]surface projection on plane of incidence"}], 12], 
          Axes -> True, AxesLabel -> Automatic, GridLines -> Automatic, 
          ImageSize -> 540, AspectRatio -> 1/GoldenRatio, Background -> 
          LightCyan, 
          PlotRangePadding -> {{Automatic, Automatic}, {0.15, Automatic}}, 
          Epilog -> {
            Inset[
             Style["interface", 12, Black], {-0.5, -0.1}], 
            Inset[
             Panel[
              Text[
               Grid[
                MapIndexed[{
                  Graphics[{
                    ColorData[1, 
                    First[#2]], Thick, 
                    Line[{{0, 0}, {1, 0}}]}, AspectRatio -> 0.1, ImageSize -> 
                   20], #}& , {
                  Subscript[
                   Style["k", Italic], "e"], 
                  Subscript[
                   Style["k", Italic], "o"], "OA", "normal"}]]]], 
             Offset[{-20, -2}, 
              Scaled[{1, 1}]], {Right, Top}]}, ContourStyle -> {
            Directive[
             ColorData[1, 1], 
             Thickness[0.004]], 
            Directive[
             ColorData[1, 2], 
             Thickness[0.004]], 
            Directive[
             ColorData[1, 3], 
             Thickness[0.006], Dashed], 
            Directive[
             ColorData[1, 4], 
             Thickness[0.008], Dashed], 
            Directive[Black, Thick]}]; $CellContext`vectors := Column[{
           Text[
            Style["Incident, reflected, and transmitted directions. ", 12]], 
           Text[
            Style[
            "Keep OA in the plane of incidence (no elevation). No TIR \
phenomena.", 12]], 
           Graphics[{{LightCyan, 
              Polygon[{{-1.3, 0}, {1.3, 0}, {1.3, 1.3}, {-1.3, 1.3}}]}, {
             Black, 
              Thickness[0.006], 
              Arrowheads[Large], 
              
              Arrow[{{-Cos[(90. - $CellContext`\[Theta]ind$$) (Pi/180.)], -
                 Sin[(90. - $CellContext`\[Theta]ind$$) (Pi/180.)]}, {0, 
                0}}]}, {Red, 
              Thickness[0.006], 
              
              Circle[{(-0.8) 
                Cos[(90. - $CellContext`\[Theta]ind$$) (Pi/180.)], (-0.8) 
                Sin[(90. - $CellContext`\[Theta]ind$$) (Pi/180.)]}, 0.04]}, {
             Red, 
              PointSize[0.015], 
              
              Point[{(-0.8) 
                Cos[(90. - $CellContext`\[Theta]ind$$) (Pi/180.)], (-0.8) 
                Sin[(90. - $CellContext`\[Theta]ind$$) (Pi/180.)]}]}, {Blue, 
              Thickness[0.006], 
              Arrowheads[{-0.03, 0.03}], 
              
              Arrow[{{(-0.7) Cos[(90 - $CellContext`\[Theta]ind$$) (Pi/180.)] + 
                 0.1 Cos[$CellContext`\[Theta]ind$$ (Pi/180.)], (-0.7) 
                  Sin[(90. - $CellContext`\[Theta]ind$$) (Pi/180.)] + (0.1 
                   Cos[$CellContext`\[Theta]ind$$ (Pi/180.)]) 
                  Tan[(-$CellContext`\[Theta]ind$$) (Pi/180.)]}, {(-0.7) 
                  Cos[(90. - $CellContext`\[Theta]ind$$) (Pi/180.)] - 0.1 
                 Cos[$CellContext`\[Theta]ind$$ (Pi/180.)], (-0.7) 
                  Sin[(90. - $CellContext`\[Theta]ind$$) (Pi/180.)] - (0.1 
                  Cos[$CellContext`\[Theta]ind$$ (Pi/180.)]) 
                 Tan[(-$CellContext`\[Theta]ind$$) (Pi/180.)]}}]}, {
              GrayLevel[0.4], 
              Thickness[0.006], 
              Arrowheads[Large], 
              Arrow[{{0, 0}, {
                 Cos[(90. - $CellContext`\[Theta]ind$$) (Pi/180.)], -
                 Sin[(90. - $CellContext`\[Theta]ind$$) (Pi/180.)]}}]}, {
             Red, 
              Thickness[0.006], 
              
              Circle[{0.7 
                Cos[(90. - $CellContext`\[Theta]ind$$) (Pi/180.)], (-0.7) 
                Sin[(90. - $CellContext`\[Theta]ind$$) (Pi/180.)]}, 0.04]}, {
             Red, 
              PointSize[0.015], 
              
              Point[{0.7 
                Cos[(90. - $CellContext`\[Theta]ind$$) (Pi/180.)], (-0.7) 
                Sin[(90. - $CellContext`\[Theta]ind$$) (Pi/180.)]}]}, {Blue, 
              Thickness[0.006], 
              Arrowheads[{-0.03, 0.03}], 
              
              Arrow[{{0.6 Cos[(90 - $CellContext`\[Theta]ind$$) (Pi/180.)] + 
                 0.1 Cos[$CellContext`\[Theta]ind$$ (Pi/180.)], (-0.6) 
                  Sin[(90. - $CellContext`\[Theta]ind$$) (Pi/180.)] - (0.1 
                  Cos[$CellContext`\[Theta]ind$$ (Pi/180.)]) 
                 Tan[(-$CellContext`\[Theta]ind$$) (Pi/180.)]}, {
                0.6 Cos[(90. - $CellContext`\[Theta]ind$$) (Pi/180.)] - 0.1 
                 Cos[$CellContext`\[Theta]ind$$ (Pi/180.)], (-0.6) 
                  Sin[(90. - $CellContext`\[Theta]ind$$) (Pi/180.)] + (0.1 
                   Cos[$CellContext`\[Theta]ind$$ (Pi/180.)]) 
                  Tan[(-$CellContext`\[Theta]ind$$) (Pi/180.)]}}]}, {Black, 
              Thickness[0.004], 
              Line[{{-1.3, 0}, {1.3, 0}}]}, {Red, 
              Thickness[0.006], 
              Arrowheads[Large], 
              Arrow[{{0, 0}, 1.2 {
                  Cos[(90. - $CellContext`\[Theta]odre) (Pi/180.)], 
                  Sin[(90. - $CellContext`\[Theta]odre) (Pi/180.)]}}]}, {
             Red, 
              Thickness[0.006], 
              
              Circle[{0.9 Cos[(90. - $CellContext`\[Theta]odre) (Pi/180.)], 
                0.9 Sin[(90. - $CellContext`\[Theta]odre) (Pi/180.)]}, 
               0.04]}, {Red, 
              PointSize[0.015], 
              
              Point[{0.9 Cos[(90. - $CellContext`\[Theta]odre) (Pi/180.)], 
                0.9 Sin[(90. - $CellContext`\[Theta]odre) (Pi/180.)]}]}, {
             Blue, 
              Thickness[0.006], 
              Arrowheads[{-0.03, 0.03}], 
              
              Arrow[{{0.8 Cos[(90. - $CellContext`\[Theta]edre) (Pi/180.)] + 
                 0.1 Cos[$CellContext`\[Theta]edre (Pi/180.)], 
                 0.8 Sin[(90. - $CellContext`\[Theta]edre) (Pi/180.)] + (0.1 
                   Cos[$CellContext`\[Theta]edre (Pi/180.)]) 
                  Tan[(-$CellContext`\[Theta]edre) (Pi/180.)]}, {
                0.8 Cos[(90. - $CellContext`\[Theta]edre) (Pi/180.)] - 0.1 
                 Cos[$CellContext`\[Theta]edre (Pi/180.)], 
                 0.8 Sin[(90. - $CellContext`\[Theta]edre) (Pi/180.)] - (0.1 
                  Cos[$CellContext`\[Theta]edre (Pi/180.)]) 
                 Tan[(-$CellContext`\[Theta]edre) (Pi/180.)]}}]}, {Blue, 
              Thickness[0.006], 
              Arrowheads[Large], 
              Arrow[{{0, 0}, 1.2 {
                  Cos[(90. - $CellContext`\[Theta]edre) (Pi/180.)], 
                  Sin[(90. - $CellContext`\[Theta]edre) (Pi/180.)]}}]}, {
             Orange, 
              Thickness[0.006], 
              Arrowheads[Large], 
              Arrow[{{0, 0}, 1.2 {
                  Cos[$CellContext`\[Theta]Pre (Pi/180.)], 
                  Sin[$CellContext`\[Theta]Pre (Pi/180.)]}}]}, {Magenta, 
              Thickness[0.006], Dashed, 
              
              Line[{{0, 0}, 
                1.2 {1.1 Cos[(90. + $CellContext`Q$$) (Pi/180.)], 1.1 
                  Sin[(90. + $CellContext`Q$$) (Pi/180.)]}}]}, {Brown, Dashed, 
              Thickness[0.006], 
              Line[{{0, -1}, {0, 1.3}}]}, 
             Inset[
              Style[
               Subscript[
                Style["k", Italic], 
                Style["o", Plain]], 17, Red], {
              1.25 Cos[(90. - $CellContext`\[Theta]odre) (Pi/180.)], 1.25 
               Sin[(90. - $CellContext`\[Theta]odre) (Pi/180.)]}], 
             Inset[
              Style[
               Subscript[
                Style["k", Italic], 
                Style["e", Plain]], 17, Blue], {
              1.25 Cos[(90. - $CellContext`\[Theta]edre) (Pi/180.)], 1.25 
               Sin[(90. - $CellContext`\[Theta]edre) (Pi/180.)]}], 
             Inset[
              Style[
               Subscript[
                Style["S", Italic], 
                Style["e", Plain]], 17, Orange], {
              1.25 Cos[$CellContext`\[Theta]Pre (Pi/180)], 1.25 
               Sin[$CellContext`\[Theta]Pre (Pi/180)]}], 
             Inset[
              Style["OA", 16, Magenta], {
              1.1 Cos[(90. + $CellContext`Q$$) (Pi/180.)], 1.1 
               Sin[(90 + $CellContext`Q$$) (Pi/180.)]}]}, 
            PlotRange -> {{-1.3, 1.3}, {-1, 1.3}}, ImageSize -> 
            0.95 {540, 350}, ImagePadding -> 5, Frame -> True, FrameTicks -> 
            None]}, Alignment -> Center]; Pane[
         Switch[$CellContext`plot$$, "data", $CellContext`info, 
          "2D k\[Hyphen]surfaces", $CellContext`surfaces, 
          "2D vectors", $CellContext`vectors, 
          "Fresnel (r, t)", $CellContext`power, "phases", $CellContext`power, 
          "Fresnel (R, T)", $CellContext`power], ImageSize -> {600, 375}]), 
      "Specifications" :> {{{$CellContext`plot$$, "2D vectors"}, {
         "data", "2D k\[Hyphen]surfaces", "2D vectors", "Fresnel (r, t)", 
          "phases", "Fresnel (R, T)"}, ControlType -> RadioButton, 
         ControlPlacement -> 1}, {{$CellContext`ni$$, 1., 
          Row[{"index ", 
            Subscript["n", "i"]}]}, 1, 2, 0.01, ImageSize -> Tiny, Appearance -> 
         "Labeled", ControlPlacement -> 2}, {{$CellContext`no$$, 1.2, 
          Row[{"index ", 
            Subscript["n", "o"]}]}, 1, 2, 0.01, ImageSize -> Tiny, Appearance -> 
         "Labeled", ControlPlacement -> 3}, {{$CellContext`ne$$, 1.6, 
          Row[{"index ", 
            Subscript["n", "e"]}]}, 1, 2, 0.01, ImageSize -> Tiny, Appearance -> 
         "Labeled", ControlPlacement -> 
         4}, {{$CellContext`\[Theta]ind$$, 50, 
          "angle of incidence (\[Degree])"}, -89.99, 89.99, 1, ImageSize -> 
         Small, Appearance -> "Labeled", ControlPlacement -> 
         5}, {{$CellContext`\[Theta]pol$$, 45, 
          "polarization (0\[Degree] is s\[Hyphen]pol.)"}, 0, 90, 1, ImageSize -> 
         Small, Appearance -> "Labeled", ControlPlacement -> 
         6}, {{$CellContext`\[Theta]$$, 0, 
          "optical axis elevation (\[Degree])"}, -90, 90, 1, ImageSize -> 
         Small, Appearance -> "Labeled", ControlPlacement -> 
         7}, {{$CellContext`Q$$, 45, 
          "optical axis rotation (\[Degree])"}, -90, 90, 1, ImageSize -> 
         Small, Appearance -> "Labeled", ControlPlacement -> 
         8}, {{$CellContext`step$$, 0.5, 
          "angular step (\[Degree]) for Fresnel"}, {0.01, 0.1, 0.2, 0.5, 1}, 
         ImageSize -> Tiny, ControlType -> RadioButton, ControlPlacement -> 
         9}, 
        Grid[{{
           Manipulate`Place[1], SpanFromLeft}, {
           Grid[{{
              Manipulate`Place[2], 
              Manipulate`Place[3], 
              Manipulate`Place[4]}}], SpanFromLeft}, {
           Manipulate`Place[5], 
           Manipulate`Place[6]}, {
           Manipulate`Place[7], 
           Manipulate`Place[8]}, {
           Manipulate`Place[9], SpanFromLeft}}, Alignment -> Left]}, 
      "Options" :> {
       ContinuousAction -> False, LabelStyle -> {12}, 
        AutorunSequencing -> {{1, 15}}, TrackedSymbols :> True}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{645., {287., 292.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->1146517906],

Cell[CellGroupData[{

Cell["CAPTION", "Section",
 CellFrame->{{0, 0}, {1, 0}},
 CellFrameColor->RGBColor[0.87, 0.87, 0.87],
 FontFamily->"Helvetica",
 FontSize->12,
 FontWeight->"Bold",
 FontColor->RGBColor[0.597406, 0, 0.0527047]],

Cell[TextData[{
 "This Demonstration investigates double refraction of an EM wave propagating \
through an isotropic medium at the interface with a uniaxial dielectric. The \
optic axis is free to rotate both in and out the plane of incidence. Ordinary \
and extraordinary waves and rays are calculated explicitly and the \
information is presented as data and graphics. Direct solution of the \
boundary conditions of the incident, reflected, and transmitted EM waves at \
the interface provides the Fresnel coefficients ",
 Cell[BoxData[
  FormBox["r", TraditionalForm]], "InlineMath"],
 ", ",
 Cell[BoxData[
  FormBox["t", TraditionalForm]], "InlineMath"],
 " and the reflectance ",
 Cell[BoxData[
  FormBox["R", TraditionalForm]], "InlineMath"],
 " and transmittance ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]], "InlineMath"],
 " as a function of the angle of incidence. You can set the index of \
refraction for that isotropic medium to explore the total internal reflection \
(TIR) phenomena."
}], "Text"]
}, Close]]
}, Open  ]],

Cell[CellGroupData[{

Cell["DETAILS", "Section",
 CellFrame->{{0, 0}, {1, 0}},
 CellFrameColor->RGBColor[0.87, 0.87, 0.87],
 FontFamily->"Helvetica",
 FontSize->12,
 FontWeight->"Bold",
 FontColor->RGBColor[0.597406, 0, 0.0527047]],

Cell["\<\
Optically anisotropic dielectrics are birefringent if their index of \
refraction for a given wavelength depends on the polarization state and the \
propagation direction of the refracted wave. Ordered materials like crystals \
have three principal indices of refraction (specific to the crystal \
structure) in the directions known as the principal axes. Together these \
constitute the principal coordinate system. If all three indices are the \
same, the material is characterized as isotropic; if two are the same, as \
uniaxial; and if all three are different, as biaxial.\
\>", "Text"],

Cell[TextData[{
 "We focus on the second case (uniaxial), where the crystal has one axis of \
symmetry (as in the trigonal, tetragonal, and hexagonal crystal systems), \
known as the optical axis (",
 Cell[BoxData[
  FormBox["OA", TraditionalForm]], "InlineMath"],
 ", ",
 Cell[BoxData[
  FormBox["z", TraditionalForm]], "InlineMath"],
 " principal axis). In the index ellipsoid notation (optical indicatrix, \
electric impermeability surface), the index of refraction along the direction \
of the optical axis is known as extraordinary, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", 
    StyleBox["e",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 ", and the two equal indices in directions perpendicular to the ",
 Cell[BoxData[
  FormBox["OA", TraditionalForm]], "InlineMath"],
 " are referred to as ordinary, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", 
    StyleBox["o",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 ". Birefringence in an isotropic-uniaxial interface for an incoming linearly \
polarized light wave is better seen as double refraction; the incoming wave \
splits into two refracted waves inside the uniaxial medium. Their propagation \
depends on their state of polarization."
}], "Text"],

Cell[TextData[{
 "In this Demonstration, the ",
 Cell[BoxData[
  FormBox["OA", TraditionalForm]], "InlineMath"],
 " is allowed to rotate not only on the plane of incidence (the ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath"],
 "-",
 Cell[BoxData[
  FormBox["z", TraditionalForm]], "InlineMath"],
 " plane in the fixed laboratory frame) but also perpendicular to that plane \
(elevation, around the ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath"],
 " axis). The coordinate system used for rotation is a fixed ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]], "InlineMath"],
 ", ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath"],
 ", ",
 Cell[BoxData[
  FormBox["z", TraditionalForm]], "InlineMath"],
 " laboratory system where the interface is the fixed ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]], "InlineMath"],
 "-",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath"],
 " plane, the normal to the interface is the lab ",
 Cell[BoxData[
  FormBox["z", TraditionalForm]], "InlineMath"],
 " axis, and the lab ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]], "InlineMath"],
 " axis is normal to the plane of incidence. The incidence plane is important \
since it contains all the wave vectors and the normal to the interface. The \
crystal is held fixed in space, with the crystal structure rotated. A \
transformation of coordinate systems has been taken into account in order to \
translate the crystal geometry from the principal coordinate system that \
rotates with the ",
 Cell[BoxData[
  FormBox["OA", TraditionalForm]], "InlineMath"],
 " to the fixed laboratory frame. The rotation transformation used always \
assumes that rotation in the plane of incidence (",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]], "InlineMath"],
 ") precedes the elevation angle ",
 Cell[BoxData[
  FormBox["\[Theta]", TraditionalForm]], "InlineMath"],
 " regardless of the order each slider was moved."
}], "Text"],

Cell[TextData[{
 "A key concept in birefringence is the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Omega]", 
    RowBox[{"(", "k", ")"}]}], TraditionalForm]], "InlineMath"],
 " dispersion relation between energy ",
 Cell[BoxData[
  FormBox["\[Omega]", TraditionalForm]], "InlineMath"],
 " and momentum (",
 Cell[BoxData[
  FormBox["k", TraditionalForm]], "InlineMath"],
 " being the wave vector) of a wave. Maxwell's equations lead to a dispersion \
relation that can be visualized as a surface in ",
 Cell[BoxData[
  FormBox["k", TraditionalForm]], "InlineMath"],
 "-space, formally known as the normal surface or the ",
 Cell[BoxData[
  FormBox["k", TraditionalForm]], "InlineMath"],
 "-surface. In uniaxial crystals, the ",
 Cell[BoxData[
  FormBox["k", TraditionalForm]], "InlineMath"],
 "-surface consists of two sheets: a sphere for the ",
 Cell[BoxData[
  FormBox[
   StyleBox["o",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath"],
 " wave and an ellipsoid of revolution for the ",
 Cell[BoxData[
  FormBox[
   StyleBox["e",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath"],
 " wave. The intersection of the ",
 Cell[BoxData[
  FormBox["k", TraditionalForm]], "InlineMath"],
 "-surfaces with the plane of incidence (the ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath"],
 "-",
 Cell[BoxData[
  FormBox["z", TraditionalForm]], "InlineMath"],
 " plane in this case) collapses the 3D constructions to a circle and an \
ellipse. Poynting vectors are normal to their corresponding ",
 Cell[BoxData[
  FormBox["k", TraditionalForm]], "InlineMath"],
 "-surface. In this Demonstration, the ",
 Cell[BoxData[
  FormBox[
   StyleBox["e",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath"],
 " ray Poynting vector ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", 
    StyleBox["e",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " are found through the geometric construction of the normal to the ellipse \
at its intersection with the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", 
    StyleBox["e",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " wave vector."
}], "Text"],

Cell[TextData[{
 "The ",
 Cell[BoxData[
  FormBox[
   StyleBox["o",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath"],
 " wave's direction of propagation is found analytically using Snell's law \
with ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", 
    StyleBox["o",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " as the corresponding index of refraction. Its polarization is \
perpendicular to the plane formed by the ",
 Cell[BoxData[
  FormBox["OA", TraditionalForm]], "InlineMath"],
 " and the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", 
    StyleBox["o",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " wave vector. The ",
 Cell[BoxData[
  FormBox[
   StyleBox["o",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath"],
 " wave's direction of propagation coincides with the corresponding energy \
flow (the direction of the Poynting vector or ray direction). The ",
 Cell[BoxData[
  FormBox[
   StyleBox["e",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath"],
 " refracted wave satisfies a modified version of Snell's law; the index of \
refraction the wave experiences depends not only on the values of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", 
    StyleBox["o",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", 
    StyleBox["e",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " of the refracting medium but is also a function of the direction of \
propagation. Here, the extraordinary wave's direction of propagation is \
solved for numerically. Its polarization vector lies in the plane formed by \
",
 Cell[BoxData[
  FormBox["OA", TraditionalForm]], "InlineMath"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", 
    StyleBox["e",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 ", and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", 
    StyleBox["e",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " (Poynting vector) and the equation of this plane is provided in the \"data\
\" section. The ",
 Cell[BoxData[
  FormBox[
   StyleBox["e",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath"],
 " waves have different directions for wave vectors and energy flow (walkoff \
angle, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "e"], TraditionalForm]], "InlineMath"],
 ", and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", "e"], TraditionalForm]], "InlineMath"],
 " angle). "
}], "Text"],

Cell[TextData[{
 "Assuming that the incoming wave's electric field has unit amplitude, then \
the reflected field will have ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["r", "s"], TraditionalForm]], "InlineMath"],
 " amplitude in the ",
 Cell[BoxData[
  FormBox[
   StyleBox["s",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath"],
 "-pol. direction (",
 Cell[BoxData[
  FormBox["x", TraditionalForm]], "InlineMath"],
 " axis) and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["r", "p"], TraditionalForm]], "InlineMath"],
 " amplitude in the ",
 Cell[BoxData[
  FormBox[
   StyleBox["p",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath"],
 "-pol. direction (plane of incidence) while the ",
 Cell[BoxData[
  FormBox[
   StyleBox["o",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath"],
 " transmitted field will have ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["t", 
    StyleBox["o",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " amplitude (in the direction defined by the cross product of the wave \
vector ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", 
    StyleBox["o",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " and the ",
 Cell[BoxData[
  FormBox["OA", TraditionalForm]], "InlineMath"],
 ") and the ",
 Cell[BoxData[
  FormBox[
   StyleBox["e",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath"],
 " transmitted field will have ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["t", 
    StyleBox["e",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " amplitude (on the plane formed by ",
 Cell[BoxData[
  FormBox["OA", TraditionalForm]], "InlineMath"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", 
    StyleBox["e",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 ", and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", 
    StyleBox["e",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " and normal to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", 
    StyleBox["e",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 "). These four quantities are known as the Fresnel coefficients. We can then \
get the power ratios ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", 
    StyleBox["s",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", 
    StyleBox["p",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", 
    StyleBox["o",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 ", and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", 
    StyleBox["e",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " with the standard procedure (intensity ratios in a unit area). The ",
 Cell[BoxData[
  FormBox["Total", TraditionalForm]], "InlineMath"],
 " value is also calculated (sum of the four power ratios) and should always \
be 1, since it represents conservation of energy."
}], "Text"],

Cell[TextData[{
 "Fresnel coefficients are derived by explicit application of electromagnetic \
boundary conditions at the interface (continuity of the tangential components \
of the electric ",
 Cell[BoxData[
  FormBox[
   StyleBox["E",
    FontWeight->"Bold",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath"],
 " and magnetic ",
 Cell[BoxData[
  FormBox[
   StyleBox["H",
    FontWeight->"Bold",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath"],
 " fields). Both the Fresnel coefficients graphs and the \
reflectance-transmittance graphs are calculated by a looping construct that \
steps the incidence angle in increments specified by the user (the highest \
accuracy comes at a premium; a 0.01 step takes about 20 seconds to evaluate). \
The Brewster angle is then deduced by finding the minimum value of the ",
 Cell[BoxData[
  FormBox[
   StyleBox["p",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath"],
 "-component of the reflected ray, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", 
    StyleBox["p",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 ". The incoming wave is taken as linearly polarized and its polarization \
direction can be decided by the user between completely ",
 Cell[BoxData[
  FormBox[
   StyleBox["s",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath"],
 "-polarized (",
 Cell[BoxData[
  FormBox["x", TraditionalForm]], "InlineMath"],
 " axis, normal to the plane of incidence, 0\[Degree] in the corresponding \
slider) and completely ",
 Cell[BoxData[
  FormBox[
   StyleBox["p",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath"],
 "-polarized (the ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath"],
 "-",
 Cell[BoxData[
  FormBox["z", TraditionalForm]], "InlineMath"],
 " plane of incidence, 90\[Degree] in the slider) in steps of one degree."
}], "Text"],

Cell[TextData[{
 "The EM boundary conditions at the interface require all wave vectors (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "inc"], TraditionalForm]], "InlineMath"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "ref"], TraditionalForm]], "InlineMath"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", 
    StyleBox["o",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 ", and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", 
    StyleBox["e",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 ") to be in the plane of incidence."
}], "Text"],

Cell[TextData[{
 "The first medium has a user-defined index of refraction (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", 
    StyleBox["i",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 ") also. When properly chosen (with respect to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", 
    StyleBox["o",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", 
    StyleBox["e",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 "), total internal reflection (TIR) phenomena are explored and the \
corresponding critical angles (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["TIR", 
    StyleBox["o",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["TIR", 
    StyleBox["e",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 ") are identified from the data (when the corresponding refraction angles \
for the rays, not the wave vectors, become complex)."
}], "Text"],

Cell[TextData[{
 "The Poynting vector ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", 
    StyleBox["e",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " is computed by finding the intersection point",
 Cell[BoxData[
  FormBox[" ", TraditionalForm]]],
 "of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", 
    StyleBox["e",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " with the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", 
    StyleBox["e",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 "-surface and evaluating the normal to the surface there. "
}], "Text"],

Cell["A brief description of the selection menu:", "Text"],

Cell["\<\
1. Raw data on wave, ray, and field directions; Fresnel coefficients; \
reflectance and transmittance.\
\>", "Text"],

Cell[TextData[{
 "2. The ",
 Cell[BoxData[
  FormBox["k", TraditionalForm]], "InlineMath"],
 "-surfaces of the ordinary and extraordinary waves inside the uniaxial \
medium (their intersection with the plane of incidence, ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath"],
 "-",
 Cell[BoxData[
  FormBox["z", TraditionalForm]], "InlineMath"],
 " plane)."
}], "Text"],

Cell[TextData[{
 "3. The corresponding directions of propagation and polarizations for the \
two wave vectors ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", 
    StyleBox["o",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", 
    StyleBox["e",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " and for the ",
 Cell[BoxData[
  FormBox[
   StyleBox["e",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath"],
 " ray/Poynting vector ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", 
    StyleBox["e",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 ". The ",
 Cell[BoxData[
  FormBox[
   StyleBox["o",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath"],
 " ray/Poynting vector coincides with the ordinary wave vector ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", 
    StyleBox["o",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 ". The polarizations refer to an ",
 Cell[BoxData[
  FormBox["OA", TraditionalForm]], "InlineMath"],
 " in the plane of incidence."
}], "Text"],

Cell[TextData[{
 "4. Fresnel coefficients ",
 Cell[BoxData[
  FormBox["r", TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox["t", TraditionalForm]], "InlineMath"],
 " (absolute values). Changing the ",
 Cell[BoxData[
  FormBox["OA", TraditionalForm]], "InlineMath"],
 " orientation affects the shape of the observed curves, while changing the \
incoming wave's polarization has a profound effect on the magnitude of the \
coefficients. "
}], "Text"],

Cell[TextData[{
 "5. Phase of the reflectance coefficients ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["r", "s"], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["r", "p"], TraditionalForm]], "InlineMath"],
 " defined as the argument of the coefficient. In the case of internal \
reflection, the phase can also take on values between 0 and ",
 Cell[BoxData[
  FormBox["\[Pi]", TraditionalForm]], "InlineMath"],
 " radians when the incoming wave's angle with the normal to the interface \
exceeds the critical angle and the coefficients become complex numbers."
}], "Text"],

Cell[TextData[{
 "6. Reflectance and transmittance ",
 Cell[BoxData[
  FormBox["R", TraditionalForm]], "InlineMath"],
 ", ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]], "InlineMath"],
 ". Except for the strictly ",
 Cell[BoxData[
  FormBox[
   StyleBox["s",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath"],
 "-polarized incident wave, the Brewster angle is found (changing the angular \
step has a direct impact on the accuracy). In the case of internal \
reflection, the critical angles (TIR angles) are also reported. Total \
reflectivity at normal incidence is also noted. The angular step provides a \
way to increase the accuracy of the reported values at the \"expense\" of \
longer evaluation times."
}], "Text"],

Cell[TextData[{
 "Snapshot 1: projection of the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "o"], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "e"], TraditionalForm]], "InlineMath"],
 " surfaces (sphere and ellipsoid of revolution) in the plane of incidence. \
The two curves are tangent along the ",
 Cell[BoxData[
  FormBox["OA", TraditionalForm]], "InlineMath"],
 " for all rotation angles if there is no elevation."
}], "Text"],

Cell["\<\
Snapshots 2 and 3: air-glass and glass-air (isotropic-isotropic) interfaces. \
Total internal reflection conditions are met in the second case for angles of \
incidence larger than about 41.5\[Degree].\
\>", "Text"],

Cell[TextData[{
 "Snapshot 4: air-calcite interface (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["n", 
     StyleBox["i",
      FontSlant->"Plain"]], "<", 
    SubscriptBox["n", 
     StyleBox["o",
      FontSlant->"Plain"]]}], TraditionalForm]], "InlineMath"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["n", 
     StyleBox["i",
      FontSlant->"Plain"]], "<", 
    SubscriptBox["n", 
     StyleBox["e",
      FontSlant->"Plain"]]}], TraditionalForm]], "InlineMath"],
 "). Calcite exhibits large negative birefringence (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["n", 
     StyleBox["o",
      FontSlant->"Plain"]], ">", 
    SubscriptBox["n", 
     StyleBox["e",
      FontSlant->"Plain"]]}], TraditionalForm]], "InlineMath"],
 "). The power curves look very similar to the ones in the air-glass \
interface (Snapshot 2)."
}], "Text"],

Cell[TextData[{
 "Snapshot 5: artificial isotropic-calcite interface (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["n", 
     StyleBox["i",
      FontSlant->"Plain"]], ">", 
    SubscriptBox["n", 
     StyleBox["o",
      FontSlant->"Plain"]]}], TraditionalForm]], "InlineMath"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["n", 
     StyleBox["i",
      FontSlant->"Plain"]], ">", 
    SubscriptBox["n", 
     StyleBox["e",
      FontSlant->"Plain"]]}], TraditionalForm]], "InlineMath"],
 "). Check the sharp rise of the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", 
    StyleBox["p",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " component in the reflected ray in the angular interval between the two TIR \
angles although the incoming polarization is polarized at 45\[Degree]. There \
are two TIR angles, one for each index of refraction."
}], "Text"],

Cell[TextData[{
 "Snapshot 6: again air-calcite interface (as in Snapshot 5) but this time \
the ",
 Cell[BoxData[
  FormBox["OA", TraditionalForm]], "InlineMath"],
 " is not rotated but elevated at 45\[Degree] from the plane of incidence. \
Notice that in the region between the two TIR angles, the reflected ray \
rotates its polarization to almost 45\[Degree] despite the incoming ray being \
only ",
 Cell[BoxData[
  FormBox[
   StyleBox["p",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath"],
 "-polarized. "
}], "Text"],

Cell["References", "Text"],

Cell[TextData[{
 "[1] B. E. A. Saleh and M. C. Teich,",
 StyleBox[" Fundamentals of Photonics",
  FontSlant->"Italic"],
 ", 2nd ed., Hoboken, NJ: John Wiley & Sons Inc., 2007."
}], "Text"],

Cell[TextData[{
 "[2] M. Sluijter, ",
 StyleBox["Ray-Optics Analysis of Homogeneous Uniaxially Anisotropic Media",
  FontSlant->"Italic"],
 ", Technical note TN-2007-00025, Philips Research Eindhoven, 2007."
}], "Text"],

Cell[TextData[{
 "[3] M. Sluijter, ",
 StyleBox["Ray-Optics Analysis of Inhomogeneous Uniaxially Anisotropic Media",
  
  FontSlant->"Italic"],
 ", Technical note TN-2007-00892, Philips Research Eindhoven, 2008."
}], "Text"],

Cell[TextData[{
 "[4] Z. Zhang and H. J. Caulfield, \"Reflection and Refraction by Interfaces \
of Uniaxial Crystals,\" ",
 StyleBox["Optics & Laser Technology",
  FontSlant->"Italic"],
 ", ",
 StyleBox["28",
  FontWeight->"Bold"],
 "(7), 1996, pp. 549\[Dash]553. doi:",
 ButtonBox["10.1016/S0030-3992(96)00022-9",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://dx.doi.org/10.1016/S0030-3992(96)00022-9"], None},
  ButtonNote->"http://dx.doi.org/10.1016/S0030-3992(96)00022-9"],
 "."
}], "Text"],

Cell[TextData[{
 "[5] E. Hecht,",
 StyleBox[" Optics",
  FontSlant->"Italic"],
 ", 4th ed., San Francisco, CA: Pearson Addison Wesley, 2002."
}], "Text"]
}, Close]],

Cell["THIS NOTEBOOK IS THE SOURCE CODE FROM", "Text",
 CellFrame->{{0, 0}, {0, 0}},
 CellMargins->{{48, 10}, {4, 28}},
 CellGroupingRules->{"SectionGrouping", 25},
 CellFrameMargins->{{48, 48}, {6, 5}},
 CellFrameColor->RGBColor[0.87, 0.87, 0.87],
 FontFamily->"Helvetica",
 FontSize->10,
 FontWeight->"Bold",
 FontColor->RGBColor[0.597406, 0, 0.0527047]],

Cell[TextData[{
 "\[NonBreakingSpace]",
 ButtonBox["Sotiris Danakas",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Sotiris+\
Danakas"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Sotiris+Danakas"]
}], "Text",
 CellMargins->{{48, Inherited}, {0, Inherited}},
 FontFamily->"Verdana",
 FontSize->10,
 FontColor->GrayLevel[0.6]],

Cell[TextData[{
 "\"",
 ButtonBox["Birefringence at an Isotropic-Uniaxial Interface: Waves, Rays, \
and Fresnel Coefficients",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/\
BirefringenceAtAnIsotropicUniaxialInterfaceWavesRaysAndFresn/"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/\
BirefringenceAtAnIsotropicUniaxialInterfaceWavesRaysAndFresn/"],
 "\"",
 "\[ParagraphSeparator]\[NonBreakingSpace]",
 ButtonBox["http://demonstrations.wolfram.com/\
BirefringenceAtAnIsotropicUniaxialInterfaceWavesRaysAndFresn/",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/\
BirefringenceAtAnIsotropicUniaxialInterfaceWavesRaysAndFresn/"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/\
BirefringenceAtAnIsotropicUniaxialInterfaceWavesRaysAndFresn/"],
 "\[ParagraphSeparator]\[NonBreakingSpace]",
 ButtonBox["Wolfram Demonstrations Project",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/"], None},
  ButtonNote->"http://demonstrations.wolfram.com/"],
 "\[ParagraphSeparator]\[NonBreakingSpace]",
 "Published: ",
 "December 2, 2012"
}], "Text",
 CellMargins->{{48, Inherited}, {0, Inherited}},
 FontFamily->"Verdana",
 FontSize->10,
 FontColor->GrayLevel[0.5]],

Cell[CellGroupData[{

Cell[TextData[{
 "A full-function Wolfram ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " system is required to edit this notebook.\n",
 StyleBox[ButtonBox["GET WOLFRAM MATHEMATICA \[RightGuillemet]",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://www.wolfram.com/products/mathematica/"], None},
  ButtonNote->"http://www.wolfram.com/products/mathematica/"],
  FontFamily->"Helvetica",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->RGBColor[1, 0.42, 0]]
}], "Text",
 CellFrame->True,
 CellMargins->{{48, 68}, {8, 28}},
 CellFrameMargins->12,
 CellFrameColor->RGBColor[0.87, 0.87, 0.87],
 CellChangeTimes->{3.3750111182355957`*^9},
 ParagraphSpacing->{1., 1.},
 FontFamily->"Verdana",
 FontSize->10,
 FontColor->GrayLevel[0.411765],
 Background->RGBColor[1, 1, 1]],

Cell[TextData[{
 "\[Copyright] ",
 StyleBox[ButtonBox["Wolfram Demonstrations Project & Contributors",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/"], None},
  ButtonNote->"http://demonstrations.wolfram.com/"],
  FontColor->GrayLevel[0.6]],
 "\[ThickSpace]\[ThickSpace]\[ThickSpace]|\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
 StyleBox[ButtonBox["Terms of Use",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/termsofuse.html"], None},
  ButtonNote->"http://demonstrations.wolfram.com/termsofuse.html"],
  FontColor->GrayLevel[0.6]],
 "\[ThickSpace]\[ThickSpace]\[ThickSpace]|\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
 StyleBox[ButtonBox["Make a new version of this Demonstration \
\[RightGuillemet]",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/participate/upload.jsp?id=\
BirefringenceAtAnIsotropicUniaxialInterfaceWavesRaysAndFresn"], None},
  ButtonNote->None],
  FontColor->GrayLevel[0.6]]
}], "Text",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellMargins->{{48, 10}, {20, 50}},
 CellFrameMargins->{{6, 0}, {6, 6}},
 CellFrameColor->GrayLevel[0.6],
 FontFamily->"Verdana",
 FontSize->9,
 FontColor->GrayLevel[0.6]]
}, Open  ]]
},
Editable->True,
Saveable->False,
ScreenStyleEnvironment->"Working",
CellInsertionPointCell->None,
WindowSize->{780, 650},
WindowMargins->{{Inherited, Inherited}, {Inherited, 0}},
WindowElements->{
 "StatusArea", "MemoryMonitor", "MagnificationPopUp", "VerticalScrollBar", 
  "MenuBar"},
WindowTitle->"Birefringence at an Isotropic-Uniaxial Interface: Waves, Rays, \
and Fresnel Coefficients - Source",
DockedCells->{},
CellContext->Notebook,
FrontEndVersion->"8.0 for Microsoft Windows (32-bit) (February 23, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[691, 24, 217, 6, 70, "Section"],
Cell[911, 32, 3700, 64, 70, "Section"],
Cell[4614, 98, 148554, 3566, 70, "Input",
 CellID->429195152]
}, Open  ]],
Cell[CellGroupData[{
Cell[153205, 3669, 56078, 1141, 70, "Output",
 CellID->1146517906],
Cell[CellGroupData[{
Cell[209308, 4814, 209, 6, 70, "Section"],
Cell[209520, 4822, 1018, 22, 70, "Text"]
}, Close]]
}, Open  ]],
Cell[CellGroupData[{
Cell[210586, 4850, 209, 6, 70, "Section"],
Cell[210798, 4858, 601, 9, 70, "Text"],
Cell[211402, 4869, 1253, 30, 70, "Text"],
Cell[212658, 4901, 1978, 51, 70, "Text"],
Cell[214639, 4954, 2147, 64, 70, "Text"],
Cell[216789, 5020, 2503, 81, 70, "Text"],
Cell[219295, 5103, 2979, 106, 70, "Text"],
Cell[222277, 5211, 1865, 52, 70, "Text"],
Cell[224145, 5265, 597, 22, 70, "Text"],
Cell[224745, 5289, 1034, 34, 70, "Text"],
Cell[225782, 5325, 618, 23, 70, "Text"],
Cell[226403, 5350, 58, 0, 70, "Text"],
Cell[226464, 5352, 126, 3, 70, "Text"],
Cell[226593, 5357, 382, 12, 70, "Text"],
Cell[226978, 5371, 1100, 40, 70, "Text"],
Cell[228081, 5413, 468, 13, 70, "Text"],
Cell[228552, 5428, 611, 15, 70, "Text"],
Cell[229166, 5445, 734, 18, 70, "Text"],
Cell[229903, 5465, 483, 14, 70, "Text"],
Cell[230389, 5481, 225, 4, 70, "Text"],
Cell[230617, 5487, 885, 33, 70, "Text"],
Cell[231505, 5522, 908, 30, 70, "Text"],
Cell[232416, 5554, 533, 14, 70, "Text"],
Cell[232952, 5570, 26, 0, 70, "Text"],
Cell[232981, 5572, 188, 5, 70, "Text"],
Cell[233172, 5579, 219, 5, 70, "Text"],
Cell[233394, 5586, 224, 6, 70, "Text"],
Cell[233621, 5594, 506, 15, 70, "Text"],
Cell[234130, 5611, 153, 5, 70, "Text"]
}, Close]],
Cell[234297, 5619, 355, 9, 70, "Text",
 CellGroupingRules->{"SectionGrouping", 25}],
Cell[234655, 5630, 419, 13, 70, "Text"],
Cell[235077, 5645, 1296, 35, 70, "Text"],
Cell[CellGroupData[{
Cell[236398, 5684, 793, 24, 70, "Text"],
Cell[237194, 5710, 1232, 33, 70, "Text"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
(* NotebookSignature sSzOhCUUyBc@aA0mPQXhZt0F *)
